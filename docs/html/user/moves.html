

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Moves &mdash; Eryn 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Priors" href="prior.html" />
    <link rel="prev" title="Backends" href="backend.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: coral" >
          

          
            <a href="../index.html" class="icon icon-home"> Eryn
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ensemble.html">Ensemble</a></li>
<li class="toctree-l1"><a class="reference internal" href="state.html">State</a></li>
<li class="toctree-l1"><a class="reference internal" href="backend.html">Backends</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Moves</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#move-parent-class">Move Parent Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#metropolis-hastings-moves">Metropolis-Hastings Moves</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mh-parent-class">MH Parent Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implemented-mh-moves">Implemented MH Moves</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#red-blue-moves">Red-Blue Moves</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#red-blue-parent-class">Red-Blue Parent Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implemented-red-blue-moves">Implemented Red-Blue Moves</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#group-moves">Group Moves</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#group-parent-class">Group Parent Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implemented-group-moves">Implemented Group Moves</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reversible-jump-moves">Reversible Jump Moves</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#reversible-jump-parent-class">Reversible Jump Parent Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#implemented-reversible-jump-moves">Implemented Reversible Jump Moves</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#utility-moves">Utility Moves</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="prior.html">Priors</a></li>
<li class="toctree-l1"><a class="reference internal" href="temper.html">Parallel Tempering</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utilities</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorial:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/Eryn_tutorial.html">Eryn</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Eryn</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Moves</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/user/moves.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="prior.html" class="btn btn-neutral float-right" title="Priors" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
      
      
        <a href="backend.html" class="btn btn-neutral float-left" title="Backends" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="moves">
<h1>Moves<a class="headerlink" href="#moves" title="Permalink to this headline">¶</a></h1>
<p>Proposal distributions for MCMC.</p>
<section id="move-parent-class">
<h2>Move Parent Class<a class="headerlink" href="#move-parent-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="eryn.moves.Move">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">eryn.moves.</span></span><span class="sig-name descname"><span class="pre">Move</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature_control</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gibbs_sampling_setup</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prevent_swaps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_supp_names_update</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_rj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.Move" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Parent class for proposals or “moves”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature_control</strong> (<a class="reference internal" href="temper.html#eryn.moves.tempering.TemperatureControl" title="eryn.moves.tempering.TemperatureControl"><code class="xref py py-class docutils literal notranslate"><span class="pre">tempering.TemperatureControl</span></code></a>, optional) – This object controls the tempering. It is passed to the parent class
to moves so that all proposals can share and use temperature settings.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>(</strong> (<em>periodic</em>) – class:<cite>eryn.utils.PeriodicContainer, optional):
This object holds periodic information and methods for periodic parameters. It is passed to the parent class
to moves so that all proposals can share and use periodic information.
(default: ``None`</cite>)</p></li>
<li><p><strong>gibbs_sampling_setup</strong> (<em>str</em><em>, </em><em>tuple</em><em>, </em><em>dict</em><em>, or </em><em>list</em><em>, </em><em>optional</em>) – This sets the Gibbs Sampling setup if
desired. The Gibbs sampling setup is completely customizable down to the leaf and parameters.
All of the separate Gibbs sampling splits will be run within 1 call to this proposal.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, run all branches and all parameters. If <code class="docutils literal notranslate"><span class="pre">str</span></code>, run all parameters within the
branch given as the string. To enter a branch with a specific set of parameters, you can
provide a 2-tuple with the first entry as the branch name and the second entry as a 2D
boolean array of shape <code class="docutils literal notranslate"><span class="pre">(nleaves_max,</span> <span class="pre">ndim)</span></code> that indicates which leaves and/or parameters
you want to run. <code class="docutils literal notranslate"><span class="pre">None</span></code> can also be entered in the second entry if all parameters are to be run.
A dictionary is also possible with keys as branch names and values as the same 2D boolean array
of shape <code class="docutils literal notranslate"><span class="pre">(nleaves_max,</span> <span class="pre">ndim)</span></code> that indicates which leaves and/or parameters
you want to run. <code class="docutils literal notranslate"><span class="pre">None</span></code> can also be entered in the value of the dictionary
if all parameters are to be run. If multiple keys are provided in the dictionary, those
branches will be run simultaneously in the proposal as one iteration of the proposing loop.
The final option is a list. This is how you make sure to run all the Gibbs splits. Each entry
of the list can be a string, 2-tuple, or dictionary as described above. The list controls
the order in which all of these splits are run. (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>prevent_swaps</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, do not perform temperature swaps in this move.</p></li>
<li><p><strong>skip_supp_names_update</strong> (<em>list</em><em>, </em><em>optional</em>) – List of names (<cite>str</cite>), that can be in any
<a class="reference internal" href="state.html#eryn.state.BranchSupplimental" title="eryn.state.BranchSupplimental"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.BranchSupplimental</span></code></a>,
to skip when updating states (<a class="reference internal" href="#eryn.moves.Move.update" title="eryn.moves.Move.update"><code class="xref py py-func docutils literal notranslate"><span class="pre">Move.update()</span></code></a>). This is useful if a
large amount of memory is stored in the branch supplimentals.</p></li>
<li><p><strong>is_rj</strong> (<em>bool</em><em>, </em><em>optional</em>) – If using RJ, this should be <code class="docutils literal notranslate"><span class="pre">True</span></code>. (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Incorrect inputs.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="eryn.moves.Move.Note">
<span class="sig-name descname"><span class="pre">Note</span></span><a class="headerlink" href="#eryn.moves.Move.Note" title="Permalink to this definition">¶</a></dt>
<dd><p>All kwargs are stored as attributes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="eryn.moves.Move.num_proposals">
<span class="sig-name descname"><span class="pre">num_proposals</span></span><a class="headerlink" href="#eryn.moves.Move.num_proposals" title="Permalink to this definition">¶</a></dt>
<dd><p>the number of times this move has been run. This is needed to
compute the acceptance fraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="eryn.moves.Move.gibbs_sampling_setup">
<span class="sig-name descname"><span class="pre">gibbs_sampling_setup</span></span><a class="headerlink" href="#eryn.moves.Move.gibbs_sampling_setup" title="Permalink to this definition">¶</a></dt>
<dd><p>All of the Gibbs sampling splits as described above.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.Move.gibbs_sampling_setup_iterator">
<span class="sig-name descname"><span class="pre">gibbs_sampling_setup_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_branch_names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.Move.gibbs_sampling_setup_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate through the gibbs splits as a generator</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>all_branch_names</strong> (<em>list</em>) – List of all branch names.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>2-tuple</em> –</p>
<dl class="simple">
<dt>Gibbs sampling split.</dt><dd><p>First entry is the branch names to run and the second entry is the index
into the leaves/parameters for this Gibbs split.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – Incorrect inputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.Move.setup_proposals">
<span class="sig-name descname"><span class="pre">setup_proposals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.Move.setup_proposals" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup proposals when gibbs sampling.</p>
<p>Get inputs into the proposal including Gibbs split information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of coordinate arrays for all branches.</p></li>
<li><p><strong>branches_inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(coords, inds, at_least_one_proposal)</dt><dd><ul class="simple">
<li><p>Coords including Gibbs sampling info.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inds</span></code> including Gibbs sampling info.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">at_least_one_proposal</span></code> is boolean. It is passed out to</dt><dd><p>indicate there is at least one leaf available for the requested branch names.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.Move.cleanup_proposals_gibbs">
<span class="sig-name descname"><span class="pre">cleanup_proposals_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.Move.cleanup_proposals_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set all not Gibbs-sampled parameters back</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>q</strong> (<em>dict</em>) – Dictionary of new coordinate arrays for all branches.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of old coordinate arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.Move.fix_logp_gibbs">
<span class="sig-name descname"><span class="pre">fix_logp_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.Move.fix_logp_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set any walker with no leaves to have logp = -np.inf</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em>) – Log of the prior going into final posterior computation.</p></li>
<li><p><strong>inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.Move.accepted">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">accepted</span></span><a class="headerlink" href="#eryn.moves.Move.accepted" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepted counts for this move.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.Move.acceptance_fraction">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">acceptance_fraction</span></span><a class="headerlink" href="#eryn.moves.Move.acceptance_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Acceptance fraction for this move.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.Move.temperature_control">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">temperature_control</span></span><a class="headerlink" href="#eryn.moves.Move.temperature_control" title="Permalink to this definition">¶</a></dt>
<dd><p>Temperature controller</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.Move.compute_log_posterior_basic">
<span class="sig-name descname"><span class="pre">compute_log_posterior_basic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.Move.compute_log_posterior_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log of posterior</p>
<p><span class="math notranslate nohighlight">\(\log{P} = \log{L} + \log{p}\)</span></p>
<p>This method is to mesh with the tempered log posterior computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logl</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-likelihood values.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-prior values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Log-Posterior values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray[ntemps, nwalkers]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.Move.tune">
<span class="sig-name descname"><span class="pre">tune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.Move.tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Tune a proposal</p>
<p>This is a place holder for tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – Current state of sampler.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Accepted values for last pass
through proposal.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.Move.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.Move.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a given subset of the ensemble with an accepted proposal</p>
<p>This class was updated from <code class="docutils literal notranslate"><span class="pre">emcee</span></code> to handle the added structure
of Eryn.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with current information.
New information is added to this state.</p></li>
<li><p><strong>new_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with information from proposed
points.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – A vector of booleans indicating
which walkers were accepted.</p></li>
<li><p><strong>subset</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em><em>, </em><em>optional</em>) – A boolean mask
indicating which walkers were included in the subset.
This can be used, for example, when updating only the
primary ensemble in a <a class="reference internal" href="#eryn.moves.RedBlueMove" title="eryn.moves.RedBlueMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedBlueMove</span></code></a>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">old_state</span></code> with accepted points added from <code class="docutils literal notranslate"><span class="pre">new_state</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="metropolis-hastings-moves">
<h2>Metropolis-Hastings Moves<a class="headerlink" href="#metropolis-hastings-moves" title="Permalink to this headline">¶</a></h2>
<section id="mh-parent-class">
<h3>MH Parent Class<a class="headerlink" href="#mh-parent-class" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="eryn.moves.MHMove">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">eryn.moves.</span></span><span class="sig-name descname"><span class="pre">MHMove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.MHMove" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#eryn.moves.Move" title="eryn.moves.move.Move"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.moves.move.Move</span></code></a></p>
<p>A general Metropolis-Hastings proposal</p>
<p>Concrete implementations can be made by providing a <code class="docutils literal notranslate"><span class="pre">get_proposal</span></code> method.
For standard Gaussian Metropolis moves, <code class="xref py py-class docutils literal notranslate"><span class="pre">moves.GaussianMove</span></code> can be used.</p>
<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.MHMove.get_proposal">
<span class="sig-name descname"><span class="pre">get_proposal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_inds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.MHMove.get_proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Get proposal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values are
np.ndarray[ntemps, nwalkers, nleaves_max, ndim] representing
coordinates for walkers.</p></li>
<li><p><strong>random</strong> (<em>object</em>) – Current random state object.</p></li>
<li><p><strong>branches_inds</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values are
np.ndarray[ntemps, nwalkers, nleaves_max] representing which
leaves are currently being used. (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>**kwargs</strong> (<em>ignored</em>) – This is added for compatibility. It is ignored in this function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(Proposed coordinates, factors) -&gt; (dict, np.ndarray)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – If proposal is not implemented in a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.MHMove.propose">
<span class="sig-name descname"><span class="pre">propose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.MHMove.propose" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the move to generate a proposal and compute the acceptance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.model.Model</span></code>) – Carrier of sampler information.</p></li>
<li><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code>) – Current state of the sampler.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>State of sampler after proposal is complete.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.MHMove.acceptance_fraction">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">acceptance_fraction</span></span><a class="headerlink" href="#eryn.moves.MHMove.acceptance_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Acceptance fraction for this move.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.MHMove.accepted">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">accepted</span></span><a class="headerlink" href="#eryn.moves.MHMove.accepted" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepted counts for this move.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.MHMove.cleanup_proposals_gibbs">
<span class="sig-name descname"><span class="pre">cleanup_proposals_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.MHMove.cleanup_proposals_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set all not Gibbs-sampled parameters back</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>q</strong> (<em>dict</em>) – Dictionary of new coordinate arrays for all branches.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of old coordinate arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.MHMove.compute_log_posterior_basic">
<span class="sig-name descname"><span class="pre">compute_log_posterior_basic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.MHMove.compute_log_posterior_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log of posterior</p>
<p><span class="math notranslate nohighlight">\(\log{P} = \log{L} + \log{p}\)</span></p>
<p>This method is to mesh with the tempered log posterior computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logl</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-likelihood values.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-prior values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Log-Posterior values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray[ntemps, nwalkers]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.MHMove.fix_logp_gibbs">
<span class="sig-name descname"><span class="pre">fix_logp_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.MHMove.fix_logp_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set any walker with no leaves to have logp = -np.inf</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em>) – Log of the prior going into final posterior computation.</p></li>
<li><p><strong>inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.MHMove.gibbs_sampling_setup_iterator">
<span class="sig-name descname"><span class="pre">gibbs_sampling_setup_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_branch_names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.MHMove.gibbs_sampling_setup_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate through the gibbs splits as a generator</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>all_branch_names</strong> (<em>list</em>) – List of all branch names.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>2-tuple</em> –</p>
<dl class="simple">
<dt>Gibbs sampling split.</dt><dd><p>First entry is the branch names to run and the second entry is the index
into the leaves/parameters for this Gibbs split.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – Incorrect inputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.MHMove.setup_proposals">
<span class="sig-name descname"><span class="pre">setup_proposals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.MHMove.setup_proposals" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup proposals when gibbs sampling.</p>
<p>Get inputs into the proposal including Gibbs split information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of coordinate arrays for all branches.</p></li>
<li><p><strong>branches_inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(coords, inds, at_least_one_proposal)</dt><dd><ul class="simple">
<li><p>Coords including Gibbs sampling info.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inds</span></code> including Gibbs sampling info.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">at_least_one_proposal</span></code> is boolean. It is passed out to</dt><dd><p>indicate there is at least one leaf available for the requested branch names.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.MHMove.temperature_control">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">temperature_control</span></span><a class="headerlink" href="#eryn.moves.MHMove.temperature_control" title="Permalink to this definition">¶</a></dt>
<dd><p>Temperature controller</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.MHMove.tune">
<span class="sig-name descname"><span class="pre">tune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.MHMove.tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Tune a proposal</p>
<p>This is a place holder for tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – Current state of sampler.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Accepted values for last pass
through proposal.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.MHMove.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.MHMove.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a given subset of the ensemble with an accepted proposal</p>
<p>This class was updated from <code class="docutils literal notranslate"><span class="pre">emcee</span></code> to handle the added structure
of Eryn.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with current information.
New information is added to this state.</p></li>
<li><p><strong>new_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with information from proposed
points.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – A vector of booleans indicating
which walkers were accepted.</p></li>
<li><p><strong>subset</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em><em>, </em><em>optional</em>) – A boolean mask
indicating which walkers were included in the subset.
This can be used, for example, when updating only the
primary ensemble in a <a class="reference internal" href="#eryn.moves.RedBlueMove" title="eryn.moves.RedBlueMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedBlueMove</span></code></a>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">old_state</span></code> with accepted points added from <code class="docutils literal notranslate"><span class="pre">new_state</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="implemented-mh-moves">
<h3>Implemented MH Moves<a class="headerlink" href="#implemented-mh-moves" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="eryn.moves.GaussianMove">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">eryn.moves.</span></span><span class="sig-name descname"><span class="pre">GaussianMove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cov_all</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'vector'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GaussianMove" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#eryn.moves.MHMove" title="eryn.moves.mh.MHMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.moves.mh.MHMove</span></code></a></p>
<p>A Metropolis step with a Gaussian proposal function.</p>
<p>This class is heavily based on the same class in <code class="docutils literal notranslate"><span class="pre">emcee</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cov</strong> (<em>dict</em>) – The covariance of the proposal function. The keys are branch names and the
values are covariance information. This information can be provided as a scalar,
vector, or matrix and the proposal will be assumed isotropic,
axis-aligned, or general, respectively.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>optional</em>) – Select the method used for updating parameters. This
can be one of <code class="docutils literal notranslate"><span class="pre">&quot;vector&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;random&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;sequential&quot;</span></code>. The
<code class="docutils literal notranslate"><span class="pre">&quot;vector&quot;</span></code> mode updates all dimensions simultaneously,
<code class="docutils literal notranslate"><span class="pre">&quot;random&quot;</span></code> randomly selects a dimension and only updates that
one, and <code class="docutils literal notranslate"><span class="pre">&quot;sequential&quot;</span></code> loops over dimensions and updates each
one in turn. (default: <code class="docutils literal notranslate"><span class="pre">&quot;vector&quot;</span></code>)</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>optional</em>) – If provided the proposal will be made with a
standard deviation uniformly selected from the range
<code class="docutils literal notranslate"><span class="pre">exp(U(-log(factor),</span> <span class="pre">log(factor)))</span> <span class="pre">*</span> <span class="pre">cov</span></code>. This is invalid for
the <code class="docutils literal notranslate"><span class="pre">&quot;vector&quot;</span></code> mode. (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Kwargs for parent classes. (default: <code class="docutils literal notranslate"><span class="pre">{}</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the proposal dimensions are invalid or if any of any of
    the other arguments are inconsistent.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GaussianMove.get_proposal">
<span class="sig-name descname"><span class="pre">get_proposal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_inds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GaussianMove.get_proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Get proposal from Gaussian distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values are
np.ndarray[ntemps, nwalkers, nleaves_max, ndim] representing
coordinates for walkers.</p></li>
<li><p><strong>random</strong> (<em>object</em>) – Current random state object.</p></li>
<li><p><strong>branches_inds</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values are
np.ndarray[ntemps, nwalkers, nleaves_max] representing which
leaves are currently being used. (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>**kwargs</strong> (<em>ignored</em>) – This is added for compatibility. It is ignored in this function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(Proposed coordinates, factors) -&gt; (dict, np.ndarray)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.GaussianMove.acceptance_fraction">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">acceptance_fraction</span></span><a class="headerlink" href="#eryn.moves.GaussianMove.acceptance_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Acceptance fraction for this move.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.GaussianMove.accepted">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">accepted</span></span><a class="headerlink" href="#eryn.moves.GaussianMove.accepted" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepted counts for this move.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GaussianMove.cleanup_proposals_gibbs">
<span class="sig-name descname"><span class="pre">cleanup_proposals_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GaussianMove.cleanup_proposals_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set all not Gibbs-sampled parameters back</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>q</strong> (<em>dict</em>) – Dictionary of new coordinate arrays for all branches.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of old coordinate arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GaussianMove.compute_log_posterior_basic">
<span class="sig-name descname"><span class="pre">compute_log_posterior_basic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GaussianMove.compute_log_posterior_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log of posterior</p>
<p><span class="math notranslate nohighlight">\(\log{P} = \log{L} + \log{p}\)</span></p>
<p>This method is to mesh with the tempered log posterior computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logl</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-likelihood values.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-prior values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Log-Posterior values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray[ntemps, nwalkers]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GaussianMove.fix_logp_gibbs">
<span class="sig-name descname"><span class="pre">fix_logp_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GaussianMove.fix_logp_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set any walker with no leaves to have logp = -np.inf</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em>) – Log of the prior going into final posterior computation.</p></li>
<li><p><strong>inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GaussianMove.gibbs_sampling_setup_iterator">
<span class="sig-name descname"><span class="pre">gibbs_sampling_setup_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_branch_names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GaussianMove.gibbs_sampling_setup_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate through the gibbs splits as a generator</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>all_branch_names</strong> (<em>list</em>) – List of all branch names.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>2-tuple</em> –</p>
<dl class="simple">
<dt>Gibbs sampling split.</dt><dd><p>First entry is the branch names to run and the second entry is the index
into the leaves/parameters for this Gibbs split.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – Incorrect inputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GaussianMove.propose">
<span class="sig-name descname"><span class="pre">propose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GaussianMove.propose" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the move to generate a proposal and compute the acceptance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.model.Model</span></code>) – Carrier of sampler information.</p></li>
<li><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code>) – Current state of the sampler.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>State of sampler after proposal is complete.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GaussianMove.setup_proposals">
<span class="sig-name descname"><span class="pre">setup_proposals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GaussianMove.setup_proposals" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup proposals when gibbs sampling.</p>
<p>Get inputs into the proposal including Gibbs split information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of coordinate arrays for all branches.</p></li>
<li><p><strong>branches_inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(coords, inds, at_least_one_proposal)</dt><dd><ul class="simple">
<li><p>Coords including Gibbs sampling info.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inds</span></code> including Gibbs sampling info.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">at_least_one_proposal</span></code> is boolean. It is passed out to</dt><dd><p>indicate there is at least one leaf available for the requested branch names.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.GaussianMove.temperature_control">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">temperature_control</span></span><a class="headerlink" href="#eryn.moves.GaussianMove.temperature_control" title="Permalink to this definition">¶</a></dt>
<dd><p>Temperature controller</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GaussianMove.tune">
<span class="sig-name descname"><span class="pre">tune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GaussianMove.tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Tune a proposal</p>
<p>This is a place holder for tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – Current state of sampler.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Accepted values for last pass
through proposal.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GaussianMove.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GaussianMove.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a given subset of the ensemble with an accepted proposal</p>
<p>This class was updated from <code class="docutils literal notranslate"><span class="pre">emcee</span></code> to handle the added structure
of Eryn.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with current information.
New information is added to this state.</p></li>
<li><p><strong>new_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with information from proposed
points.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – A vector of booleans indicating
which walkers were accepted.</p></li>
<li><p><strong>subset</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em><em>, </em><em>optional</em>) – A boolean mask
indicating which walkers were included in the subset.
This can be used, for example, when updating only the
primary ensemble in a <a class="reference internal" href="#eryn.moves.RedBlueMove" title="eryn.moves.RedBlueMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedBlueMove</span></code></a>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">old_state</span></code> with accepted points added from <code class="docutils literal notranslate"><span class="pre">new_state</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerate">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">eryn.moves.</span></span><span class="sig-name descname"><span class="pre">DistributionGenerate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#eryn.moves.MHMove" title="eryn.moves.mh.MHMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.moves.mh.MHMove</span></code></a></p>
<p>Generate proposals from prior</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>priors</strong> (<em>object</em>) – <code class="xref py py-class docutils literal notranslate"><span class="pre">ProbDistContainer</span></code> object that has <code class="docutils literal notranslate"><span class="pre">logpdf</span></code>
and <code class="docutils literal notranslate"><span class="pre">rvs</span></code> methods.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerate.get_proposal">
<span class="sig-name descname"><span class="pre">get_proposal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerate.get_proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a proposal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_coords</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code>. Values are
np.ndarray[ntemps, nwalkers, nleaves_max, ndim]. These are the curent
coordinates for all the walkers.</p></li>
<li><p><strong>all_inds</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code>. Values are
np.ndarray[ntemps, nwalkers, nleaves_max]. These are the boolean
arrays marking which leaves are currently used within each walker.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple containing proposal information.</dt><dd><p>First entry is the new coordinates as a dictionary with keys
as <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values as
<code class="docutils literal notranslate"><span class="pre">double</span> <span class="pre">``</span> <span class="pre">np.ndarray[ntemps,</span> <span class="pre">nwalkers,</span> <span class="pre">nleaves_max,</span> <span class="pre">ndim]</span> <span class="pre">containing</span>
<span class="pre">proposed</span> <span class="pre">coordinates.</span> <span class="pre">Second</span> <span class="pre">entry</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">new</span> <span class="pre">``inds</span></code> array with
boolean values flipped for added or removed sources. Third entry
is the factors associated with the
proposal necessary for detailed balance. This is effectively
any term in the detailed balance fraction. +log of factors if
in the numerator. -log of factors if in the denominator.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerate.acceptance_fraction">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">acceptance_fraction</span></span><a class="headerlink" href="#eryn.moves.DistributionGenerate.acceptance_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Acceptance fraction for this move.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerate.accepted">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">accepted</span></span><a class="headerlink" href="#eryn.moves.DistributionGenerate.accepted" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepted counts for this move.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerate.cleanup_proposals_gibbs">
<span class="sig-name descname"><span class="pre">cleanup_proposals_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerate.cleanup_proposals_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set all not Gibbs-sampled parameters back</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>q</strong> (<em>dict</em>) – Dictionary of new coordinate arrays for all branches.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of old coordinate arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerate.compute_log_posterior_basic">
<span class="sig-name descname"><span class="pre">compute_log_posterior_basic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerate.compute_log_posterior_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log of posterior</p>
<p><span class="math notranslate nohighlight">\(\log{P} = \log{L} + \log{p}\)</span></p>
<p>This method is to mesh with the tempered log posterior computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logl</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-likelihood values.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-prior values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Log-Posterior values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray[ntemps, nwalkers]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerate.fix_logp_gibbs">
<span class="sig-name descname"><span class="pre">fix_logp_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerate.fix_logp_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set any walker with no leaves to have logp = -np.inf</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em>) – Log of the prior going into final posterior computation.</p></li>
<li><p><strong>inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerate.gibbs_sampling_setup_iterator">
<span class="sig-name descname"><span class="pre">gibbs_sampling_setup_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_branch_names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerate.gibbs_sampling_setup_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate through the gibbs splits as a generator</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>all_branch_names</strong> (<em>list</em>) – List of all branch names.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>2-tuple</em> –</p>
<dl class="simple">
<dt>Gibbs sampling split.</dt><dd><p>First entry is the branch names to run and the second entry is the index
into the leaves/parameters for this Gibbs split.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – Incorrect inputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerate.propose">
<span class="sig-name descname"><span class="pre">propose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerate.propose" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the move to generate a proposal and compute the acceptance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.model.Model</span></code>) – Carrier of sampler information.</p></li>
<li><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code>) – Current state of the sampler.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>State of sampler after proposal is complete.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerate.setup_proposals">
<span class="sig-name descname"><span class="pre">setup_proposals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerate.setup_proposals" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup proposals when gibbs sampling.</p>
<p>Get inputs into the proposal including Gibbs split information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of coordinate arrays for all branches.</p></li>
<li><p><strong>branches_inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(coords, inds, at_least_one_proposal)</dt><dd><ul class="simple">
<li><p>Coords including Gibbs sampling info.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inds</span></code> including Gibbs sampling info.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">at_least_one_proposal</span></code> is boolean. It is passed out to</dt><dd><p>indicate there is at least one leaf available for the requested branch names.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerate.temperature_control">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">temperature_control</span></span><a class="headerlink" href="#eryn.moves.DistributionGenerate.temperature_control" title="Permalink to this definition">¶</a></dt>
<dd><p>Temperature controller</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerate.tune">
<span class="sig-name descname"><span class="pre">tune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerate.tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Tune a proposal</p>
<p>This is a place holder for tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – Current state of sampler.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Accepted values for last pass
through proposal.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerate.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerate.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a given subset of the ensemble with an accepted proposal</p>
<p>This class was updated from <code class="docutils literal notranslate"><span class="pre">emcee</span></code> to handle the added structure
of Eryn.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with current information.
New information is added to this state.</p></li>
<li><p><strong>new_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with information from proposed
points.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – A vector of booleans indicating
which walkers were accepted.</p></li>
<li><p><strong>subset</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em><em>, </em><em>optional</em>) – A boolean mask
indicating which walkers were included in the subset.
This can be used, for example, when updating only the
primary ensemble in a <a class="reference internal" href="#eryn.moves.RedBlueMove" title="eryn.moves.RedBlueMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedBlueMove</span></code></a>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">old_state</span></code> with accepted points added from <code class="docutils literal notranslate"><span class="pre">new_state</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="red-blue-moves">
<h2>Red-Blue Moves<a class="headerlink" href="#red-blue-moves" title="Permalink to this headline">¶</a></h2>
<section id="red-blue-parent-class">
<h3>Red-Blue Parent Class<a class="headerlink" href="#red-blue-parent-class" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="eryn.moves.RedBlueMove">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">eryn.moves.</span></span><span class="sig-name descname"><span class="pre">RedBlueMove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nsplits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomize_split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">live_dangerously</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.RedBlueMove" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#eryn.moves.Move" title="eryn.moves.move.Move"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.moves.move.Move</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>An abstract red-blue ensemble move with parallelization as described in
<a class="reference external" href="https://arxiv.org/abs/1202.3665">Foreman-Mackey et al. (2013)</a>.</p>
<p>This class is heavily based on the original from <code class="docutils literal notranslate"><span class="pre">emcee</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nsplits</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of sub-ensembles to use. Each
sub-ensemble is updated in parallel using the other sets as the
complementary ensemble. The default value is <code class="docutils literal notranslate"><span class="pre">2</span></code> and you
probably won’t need to change that.</p></li>
<li><p><strong>randomize_split</strong> (<em>bool</em><em>, </em><em>optional</em>) – Randomly shuffle walkers between
sub-ensembles. The same number of walkers will be assigned to
each sub-ensemble on each iteration. (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
<li><p><strong>live_dangerously</strong> (<em>bool</em><em>, </em><em>optional</em>) – By default, an update will fail with
a <code class="docutils literal notranslate"><span class="pre">RuntimeError</span></code> if the number of walkers is smaller than twice
the dimension of the problem because the walkers would then be
stuck on a low dimensional subspace. This can be avoided by
switching between the stretch move and, for example, a
Metropolis-Hastings step. If you want to do this and suppress the
error, set <code class="docutils literal notranslate"><span class="pre">live_dangerously</span> <span class="pre">=</span> <span class="pre">True</span></code>. Thanks goes (once again)
to &#64;dstndstn for this wonderful terminology. (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Kwargs for parent classes.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.RedBlueMove.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.RedBlueMove.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Any setup necessary for the proposal</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.RedBlueMove.get_proposal">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">get_proposal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complement</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gibbs_ndim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.RedBlueMove.get_proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a proposal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code>. Values are
np.ndarray[ntemps, nwalkers, nleaves_max, ndim].</p></li>
<li><p><strong>complement</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code>. Values are lists of other
other np.ndarray[ntemps, nwalkers - subset size, nleaves_max, ndim] from
all other subsets. This is the compliment whose <code class="docutils literal notranslate"><span class="pre">coords</span></code> are
used to form the proposal for the <code class="docutils literal notranslate"><span class="pre">sample</span></code> subset.</p></li>
<li><p><strong>random</strong> (<em>object</em>) – Current random state of the sampler.</p></li>
<li><p><strong>gibbs_ndim</strong> (<em>int</em><em> or </em><em>np.ndarray</em><em>, </em><em>optional</em>) – If Gibbs sampling, this indicates
the true dimension. If given as an array, must have shape <code class="docutils literal notranslate"><span class="pre">(ntemps,</span> <span class="pre">nwalkers)</span></code>.
See the tutorial for more information.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple contained proposal information.</dt><dd><p>First entry is the new coordinates as a dictionary with keys
as <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values as np.ndarray[ntemps, nwalkers, nleaves_max, ndim]
of new coordinates. Second entry is the factors associated with the
proposal necessary for detailed balance. This is effectively
any term in the detailed balance fraction. +log of factors if
in the numerator. -log of factors if in the denominator.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.RedBlueMove.propose">
<span class="sig-name descname"><span class="pre">propose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.RedBlueMove.propose" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the move to generate a proposal and compute the acceptance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.model.Model</span></code>) – Carrier of sampler information.</p></li>
<li><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code>) – Current state of the sampler.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(state, accepted)</dt><dd><p>The first return is the state of the sampler after the move.
The second return value is the accepted count array.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.RedBlueMove.acceptance_fraction">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">acceptance_fraction</span></span><a class="headerlink" href="#eryn.moves.RedBlueMove.acceptance_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Acceptance fraction for this move.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.RedBlueMove.accepted">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">accepted</span></span><a class="headerlink" href="#eryn.moves.RedBlueMove.accepted" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepted counts for this move.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.RedBlueMove.cleanup_proposals_gibbs">
<span class="sig-name descname"><span class="pre">cleanup_proposals_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.RedBlueMove.cleanup_proposals_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set all not Gibbs-sampled parameters back</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>q</strong> (<em>dict</em>) – Dictionary of new coordinate arrays for all branches.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of old coordinate arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.RedBlueMove.compute_log_posterior_basic">
<span class="sig-name descname"><span class="pre">compute_log_posterior_basic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.RedBlueMove.compute_log_posterior_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log of posterior</p>
<p><span class="math notranslate nohighlight">\(\log{P} = \log{L} + \log{p}\)</span></p>
<p>This method is to mesh with the tempered log posterior computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logl</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-likelihood values.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-prior values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Log-Posterior values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray[ntemps, nwalkers]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.RedBlueMove.fix_logp_gibbs">
<span class="sig-name descname"><span class="pre">fix_logp_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.RedBlueMove.fix_logp_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set any walker with no leaves to have logp = -np.inf</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em>) – Log of the prior going into final posterior computation.</p></li>
<li><p><strong>inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.RedBlueMove.gibbs_sampling_setup_iterator">
<span class="sig-name descname"><span class="pre">gibbs_sampling_setup_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_branch_names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.RedBlueMove.gibbs_sampling_setup_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate through the gibbs splits as a generator</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>all_branch_names</strong> (<em>list</em>) – List of all branch names.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>2-tuple</em> –</p>
<dl class="simple">
<dt>Gibbs sampling split.</dt><dd><p>First entry is the branch names to run and the second entry is the index
into the leaves/parameters for this Gibbs split.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – Incorrect inputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.RedBlueMove.setup_proposals">
<span class="sig-name descname"><span class="pre">setup_proposals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.RedBlueMove.setup_proposals" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup proposals when gibbs sampling.</p>
<p>Get inputs into the proposal including Gibbs split information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of coordinate arrays for all branches.</p></li>
<li><p><strong>branches_inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(coords, inds, at_least_one_proposal)</dt><dd><ul class="simple">
<li><p>Coords including Gibbs sampling info.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inds</span></code> including Gibbs sampling info.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">at_least_one_proposal</span></code> is boolean. It is passed out to</dt><dd><p>indicate there is at least one leaf available for the requested branch names.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.RedBlueMove.temperature_control">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">temperature_control</span></span><a class="headerlink" href="#eryn.moves.RedBlueMove.temperature_control" title="Permalink to this definition">¶</a></dt>
<dd><p>Temperature controller</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.RedBlueMove.tune">
<span class="sig-name descname"><span class="pre">tune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.RedBlueMove.tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Tune a proposal</p>
<p>This is a place holder for tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – Current state of sampler.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Accepted values for last pass
through proposal.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.RedBlueMove.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.RedBlueMove.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a given subset of the ensemble with an accepted proposal</p>
<p>This class was updated from <code class="docutils literal notranslate"><span class="pre">emcee</span></code> to handle the added structure
of Eryn.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with current information.
New information is added to this state.</p></li>
<li><p><strong>new_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with information from proposed
points.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – A vector of booleans indicating
which walkers were accepted.</p></li>
<li><p><strong>subset</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em><em>, </em><em>optional</em>) – A boolean mask
indicating which walkers were included in the subset.
This can be used, for example, when updating only the
primary ensemble in a <a class="reference internal" href="#eryn.moves.RedBlueMove" title="eryn.moves.RedBlueMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedBlueMove</span></code></a>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">old_state</span></code> with accepted points added from <code class="docutils literal notranslate"><span class="pre">new_state</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="implemented-red-blue-moves">
<h3>Implemented Red-Blue Moves<a class="headerlink" href="#implemented-red-blue-moves" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="eryn.moves.StretchMove">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">eryn.moves.</span></span><span class="sig-name descname"><span class="pre">StretchMove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#eryn.moves.RedBlueMove" title="eryn.moves.red_blue.RedBlueMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.moves.red_blue.RedBlueMove</span></code></a></p>
<p>Affine-Invariant Proposal</p>
<p>A <a class="reference external" href="https://msp.org/camcos/2010/5-1/p04.xhtml">Goodman &amp; Weare (2010)</a> “stretch move” with
parallelization as described in <a class="reference external" href="https://arxiv.org/abs/1202.3665">Foreman-Mackey et al. (2013)</a>.</p>
<p>This class was originally implemented in <code class="docutils literal notranslate"><span class="pre">emcee</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>double</em><em>, </em><em>optional</em>) – The stretch scale parameter. (default: <code class="docutils literal notranslate"><span class="pre">2.0</span></code>)</p></li>
<li><p><strong>use_gpu</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, use <code class="docutils literal notranslate"><span class="pre">CuPy</span></code> for computations.
Use <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> if <code class="docutils literal notranslate"><span class="pre">use_gpu</span> <span class="pre">==</span> <span class="pre">False</span></code>. (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
<li><p><strong>return_gpu</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">use_gpu</span> <span class="pre">==</span> <span class="pre">True</span> <span class="pre">and</span> <span class="pre">return_gpu</span> <span class="pre">==</span> <span class="pre">True</span></code>,
the returned arrays will be returned as <code class="docutils literal notranslate"><span class="pre">CuPy</span></code> arrays. (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
<li><p><strong>random_seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Set the random seed in <code class="docutils literal notranslate"><span class="pre">CuPy/NumPy</span></code> if not <code class="docutils literal notranslate"><span class="pre">None</span></code>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Additional keyword arguments passed down through <a href="#id2"><span class="problematic" id="id3">:class:`RedRedBlueMove`_</span></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="eryn.moves.StretchMove.a">
<span class="sig-name descname"><span class="pre">a</span></span><a class="headerlink" href="#eryn.moves.StretchMove.a" title="Permalink to this definition">¶</a></dt>
<dd><p>The stretch scale parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>double</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="eryn.moves.StretchMove.xp">
<span class="sig-name descname"><span class="pre">xp</span></span><a class="headerlink" href="#eryn.moves.StretchMove.xp" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">NumPy</span></code> or <code class="docutils literal notranslate"><span class="pre">CuPy</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>obj</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="eryn.moves.StretchMove.use_gpu">
<span class="sig-name descname"><span class="pre">use_gpu</span></span><a class="headerlink" href="#eryn.moves.StretchMove.use_gpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether <code class="docutils literal notranslate"><span class="pre">Cupy</span></code> (<code class="docutils literal notranslate"><span class="pre">True</span></code>) is used or not (<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="eryn.moves.StretchMove.return_gpu">
<span class="sig-name descname"><span class="pre">return_gpu</span></span><a class="headerlink" href="#eryn.moves.StretchMove.return_gpu" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether the array being returned is in <code class="docutils literal notranslate"><span class="pre">Cupy</span></code> (<code class="docutils literal notranslate"><span class="pre">True</span></code>)
or <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> (<code class="docutils literal notranslate"><span class="pre">False</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.StretchMove.adjust_factors">
<span class="sig-name descname"><span class="pre">adjust_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndims_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndims_new</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove.adjust_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjust the <code class="docutils literal notranslate"><span class="pre">factors</span></code> based on changing dimensions.</p>
<p><code class="docutils literal notranslate"><span class="pre">factors</span></code> is adjusted in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>factors</strong> (<em>xp.ndarray</em>) – Array of <code class="docutils literal notranslate"><span class="pre">factors</span></code> values. It is adjusted in place.</p></li>
<li><p><strong>ndims_old</strong> (<em>int</em><em> or </em><em>xp.ndarray</em>) – Old dimension. If given as an <code class="docutils literal notranslate"><span class="pre">xp.ndarray</span></code>,
must be broadcastable with <code class="docutils literal notranslate"><span class="pre">factors</span></code>.</p></li>
<li><p><strong>ndims_new</strong> (<em>int</em><em> or </em><em>xp.ndarray</em>) – New dimension. If given as an <code class="docutils literal notranslate"><span class="pre">xp.ndarray</span></code>,
must be broadcastable with <code class="docutils literal notranslate"><span class="pre">factors</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.StretchMove.choose_c_vals">
<span class="sig-name descname"><span class="pre">choose_c_vals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ntemps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_number_generator</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove.choose_c_vals" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the compliment array</p>
<p>The compliment represents the points that are used to move the actual points whose position is
changing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> (<em>np.ndarray</em>) – Possible compliment values with shape <code class="docutils literal notranslate"><span class="pre">(ntemps,</span> <span class="pre">Nc,</span> <span class="pre">nleaves_max,</span> <span class="pre">ndim)</span></code>.</p></li>
<li><p><strong>Nc</strong> (<em>int</em>) – Length of the <code class="docutils literal notranslate"><span class="pre">...</span></code>: the subset of walkers proposed to move now (usually nwalkers/2).</p></li>
<li><p><strong>Ns</strong> (<em>int</em>) – Number of generation points.</p></li>
<li><p><strong>ntemps</strong> (<em>int</em>) – Number of temperatures.</p></li>
<li><p><strong>random_number_generator</strong> (<em>object</em>) – Random state object.</p></li>
<li><p><strong>**kwargs</strong> (<em>ignored</em>) – Ignored here. For modularity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Compliment values to use with shape <code class="docutils literal notranslate"><span class="pre">(ntemps,</span> <span class="pre">Ns,</span> <span class="pre">nleaves_max,</span> <span class="pre">ndim)</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.StretchMove.get_new_points">
<span class="sig-name descname"><span class="pre">get_new_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_number_generator</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove.get_new_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Get mew points in stretch move.</p>
<p>Takes compliment and uses it to get new points for those being proposed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Branch name.</p></li>
<li><p><strong>s</strong> (<em>np.ndarray</em>) – Points to be moved with shape <code class="docutils literal notranslate"><span class="pre">(ntemps,</span> <span class="pre">Ns,</span> <span class="pre">nleaves_max,</span> <span class="pre">ndim)</span></code>.</p></li>
<li><p><strong>c</strong> (<em>np.ndarray</em>) – Compliment to move points with shape <code class="docutils literal notranslate"><span class="pre">(ntemps,</span> <span class="pre">Ns,</span> <span class="pre">nleaves_max,</span> <span class="pre">ndim)</span></code>.</p></li>
<li><p><strong>Ns</strong> (<em>int</em>) – Number to generate.</p></li>
<li><p><strong>branch_shape</strong> (<em>tuple</em>) – Full branch shape.</p></li>
<li><p><strong>branch_i</strong> (<em>int</em>) – Which branch in the order is being run now. This ensures that the
randomly generated quantity per walker remains the same over branches.</p></li>
<li><p><strong>random_number_generator</strong> (<em>object</em>) – Random state object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>New proposed points with shape <code class="docutils literal notranslate"><span class="pre">(ntemps,</span> <span class="pre">Ns,</span> <span class="pre">nleaves_max,</span> <span class="pre">ndim)</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.StretchMove.acceptance_fraction">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">acceptance_fraction</span></span><a class="headerlink" href="#eryn.moves.StretchMove.acceptance_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Acceptance fraction for this move.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.StretchMove.accepted">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">accepted</span></span><a class="headerlink" href="#eryn.moves.StretchMove.accepted" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepted counts for this move.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.StretchMove.cleanup_proposals_gibbs">
<span class="sig-name descname"><span class="pre">cleanup_proposals_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove.cleanup_proposals_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set all not Gibbs-sampled parameters back</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>q</strong> (<em>dict</em>) – Dictionary of new coordinate arrays for all branches.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of old coordinate arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.StretchMove.compute_log_posterior_basic">
<span class="sig-name descname"><span class="pre">compute_log_posterior_basic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove.compute_log_posterior_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log of posterior</p>
<p><span class="math notranslate nohighlight">\(\log{P} = \log{L} + \log{p}\)</span></p>
<p>This method is to mesh with the tempered log posterior computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logl</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-likelihood values.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-prior values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Log-Posterior values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray[ntemps, nwalkers]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.StretchMove.fix_logp_gibbs">
<span class="sig-name descname"><span class="pre">fix_logp_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove.fix_logp_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set any walker with no leaves to have logp = -np.inf</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em>) – Log of the prior going into final posterior computation.</p></li>
<li><p><strong>inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.StretchMove.get_proposal">
<span class="sig-name descname"><span class="pre">get_proposal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_all</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_all</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gibbs_ndim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove.get_proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate stretch proposal</p>
<p># TODO: add log proposal from ptemcee</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s_all</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values are coordinates
for which a proposal is to be generated.</p></li>
<li><p><strong>c_all</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values are lists. These
lists contain all the complement array values.</p></li>
<li><p><strong>random</strong> (<em>object</em>) – Random state object.</p></li>
<li><p><strong>gibbs_ndim</strong> (<em>int</em><em> or </em><em>np.ndarray</em><em>, </em><em>optional</em>) – If Gibbs sampling, this indicates
the true dimension. If given as an array, must have shape <code class="docutils literal notranslate"><span class="pre">(ntemps,</span> <span class="pre">nwalkers)</span></code>.
See the tutorial for more information.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>First entry is new positions. Second entry is detailed balance factors.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Issues with dimensionality.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.StretchMove.gibbs_sampling_setup_iterator">
<span class="sig-name descname"><span class="pre">gibbs_sampling_setup_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_branch_names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove.gibbs_sampling_setup_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate through the gibbs splits as a generator</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>all_branch_names</strong> (<em>list</em>) – List of all branch names.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>2-tuple</em> –</p>
<dl class="simple">
<dt>Gibbs sampling split.</dt><dd><p>First entry is the branch names to run and the second entry is the index
into the leaves/parameters for this Gibbs split.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – Incorrect inputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.StretchMove.propose">
<span class="sig-name descname"><span class="pre">propose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove.propose" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the move to generate a proposal and compute the acceptance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.model.Model</span></code>) – Carrier of sampler information.</p></li>
<li><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code>) – Current state of the sampler.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(state, accepted)</dt><dd><p>The first return is the state of the sampler after the move.
The second return value is the accepted count array.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.StretchMove.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Any setup necessary for the proposal</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.StretchMove.setup_proposals">
<span class="sig-name descname"><span class="pre">setup_proposals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove.setup_proposals" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup proposals when gibbs sampling.</p>
<p>Get inputs into the proposal including Gibbs split information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of coordinate arrays for all branches.</p></li>
<li><p><strong>branches_inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(coords, inds, at_least_one_proposal)</dt><dd><ul class="simple">
<li><p>Coords including Gibbs sampling info.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inds</span></code> including Gibbs sampling info.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">at_least_one_proposal</span></code> is boolean. It is passed out to</dt><dd><p>indicate there is at least one leaf available for the requested branch names.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.StretchMove.temperature_control">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">temperature_control</span></span><a class="headerlink" href="#eryn.moves.StretchMove.temperature_control" title="Permalink to this definition">¶</a></dt>
<dd><p>Temperature controller</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.StretchMove.tune">
<span class="sig-name descname"><span class="pre">tune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove.tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Tune a proposal</p>
<p>This is a place holder for tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – Current state of sampler.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Accepted values for last pass
through proposal.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.StretchMove.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.StretchMove.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a given subset of the ensemble with an accepted proposal</p>
<p>This class was updated from <code class="docutils literal notranslate"><span class="pre">emcee</span></code> to handle the added structure
of Eryn.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with current information.
New information is added to this state.</p></li>
<li><p><strong>new_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with information from proposed
points.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – A vector of booleans indicating
which walkers were accepted.</p></li>
<li><p><strong>subset</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em><em>, </em><em>optional</em>) – A boolean mask
indicating which walkers were included in the subset.
This can be used, for example, when updating only the
primary ensemble in a <a class="reference internal" href="#eryn.moves.RedBlueMove" title="eryn.moves.RedBlueMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedBlueMove</span></code></a>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">old_state</span></code> with accepted points added from <code class="docutils literal notranslate"><span class="pre">new_state</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="group-moves">
<h2>Group Moves<a class="headerlink" href="#group-moves" title="Permalink to this headline">¶</a></h2>
<section id="group-parent-class">
<h3>Group Parent Class<a class="headerlink" href="#group-parent-class" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="eryn.moves.GroupMove">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">eryn.moves.</span></span><span class="sig-name descname"><span class="pre">GroupMove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nfriends</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gibbs_sampling_leaves_per</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_iter_update</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">live_dangerously</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_branches</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupMove" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#eryn.moves.Move" title="eryn.moves.move.Move"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.moves.move.Move</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>An abstract red-blue ensemble move with parallelization as described in
<a class="reference external" href="https://arxiv.org/abs/1202.3665">Foreman-Mackey et al. (2013)</a>.</p>
<p># TODO: think about this for reversible jump.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nfriends</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of sub-ensembles to use. Each
sub-ensemble is updated in parallel using the other sets as the
complementary ensemble. The default value is <code class="docutils literal notranslate"><span class="pre">2</span></code> and you
probably won’t need to change that.</p></li>
<li><p><strong>randomize_split</strong> (<em>bool</em><em>, </em><em>optional</em>) – Randomly shuffle walkers between
sub-ensembles. The same number of walkers will be assigned to
each sub-ensemble on each iteration. By default, this is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>live_dangerously</strong> (<em>bool</em><em>, </em><em>optional</em>) – By default, an update will fail with
a <code class="docutils literal notranslate"><span class="pre">RuntimeError</span></code> if the number of walkers is smaller than twice
the dimension of the problem because the walkers would then be
stuck on a low dimensional subspace. This can be avoided by
switching between the stretch move and, for example, a
Metropolis-Hastings step. If you want to do this and suppress the
error, set <code class="docutils literal notranslate"><span class="pre">live_dangerously</span> <span class="pre">=</span> <span class="pre">True</span></code>. Thanks goes (once again)
to &#64;dstndstn for this wonderful terminology.</p></li>
<li><p><strong>gibbs_sampling_leaves_per</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of individual leaves
to sample over during Gibbs Sampling. <code class="docutils literal notranslate"><span class="pre">None</span></code> means there will be
no Gibbs sampling. Currently, if you specify anything other than <code class="docutils literal notranslate"><span class="pre">None</span></code>,
it will split up different branches automatically and then Gibbs sample
over each branch indivudally. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">kwargs</span></code> are passed to <a class="reference internal" href="#eryn.moves.Move" title="eryn.moves.Move"><code class="xref py py-class docutils literal notranslate"><span class="pre">Move</span></code></a> class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupMove.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branches</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupMove.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Any setup necessary for the proposal</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupMove.get_proposal">
<em class="property"><span class="pre">classmethod</span> </em><span class="sig-name descname"><span class="pre">get_proposal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complement</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupMove.get_proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a proposal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code>. Values are
np.ndarray[subset size, nleaves_max, ndim]. This is the subset
whose <code class="docutils literal notranslate"><span class="pre">coords</span></code> are being proposed.</p></li>
<li><p><strong>complement</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code>. Values are lists of other
other np.ndarray[nwalkers - subset size, nleaves_max, ndim] from
all other subsets. This is the compliment whose <code class="docutils literal notranslate"><span class="pre">coords</span></code> are
used to form the proposal for the <code class="docutils literal notranslate"><span class="pre">sample</span></code> subset.</p></li>
<li><p><strong>random</strong> (<em>object</em>) – Current random state of the sampler.</p></li>
<li><p><strong>inds</strong> (<em>dict</em><em>, </em><em>optional</em>) – # TODO check this.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple contained proposal information.</dt><dd><p>First entry is the new coordinates as a dictionary with keys
as <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values as np.ndarray[subset size, ndim * nleaves_max]
of new coordinates. Second entry is the factors associated with the
proposal necessary for detailed balance. This is effectively
any term in the detailed balance fraction. +log of factors if
in the numerator. -log of factors if in the denominator.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupMove.propose">
<span class="sig-name descname"><span class="pre">propose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupMove.propose" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the move to generate a proposal and compute the acceptance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.model.Model</span></code>) – Carrier of sampler information.</p></li>
<li><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code>) – Current state of the sampler.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>State of sampler after proposal is complete.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.GroupMove.acceptance_fraction">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">acceptance_fraction</span></span><a class="headerlink" href="#eryn.moves.GroupMove.acceptance_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Acceptance fraction for this move.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.GroupMove.accepted">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">accepted</span></span><a class="headerlink" href="#eryn.moves.GroupMove.accepted" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepted counts for this move.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupMove.cleanup_proposals_gibbs">
<span class="sig-name descname"><span class="pre">cleanup_proposals_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupMove.cleanup_proposals_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set all not Gibbs-sampled parameters back</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>q</strong> (<em>dict</em>) – Dictionary of new coordinate arrays for all branches.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of old coordinate arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupMove.compute_log_posterior_basic">
<span class="sig-name descname"><span class="pre">compute_log_posterior_basic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupMove.compute_log_posterior_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log of posterior</p>
<p><span class="math notranslate nohighlight">\(\log{P} = \log{L} + \log{p}\)</span></p>
<p>This method is to mesh with the tempered log posterior computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logl</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-likelihood values.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-prior values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Log-Posterior values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray[ntemps, nwalkers]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupMove.fix_logp_gibbs">
<span class="sig-name descname"><span class="pre">fix_logp_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupMove.fix_logp_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set any walker with no leaves to have logp = -np.inf</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em>) – Log of the prior going into final posterior computation.</p></li>
<li><p><strong>inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupMove.gibbs_sampling_setup_iterator">
<span class="sig-name descname"><span class="pre">gibbs_sampling_setup_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_branch_names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupMove.gibbs_sampling_setup_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate through the gibbs splits as a generator</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>all_branch_names</strong> (<em>list</em>) – List of all branch names.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>2-tuple</em> –</p>
<dl class="simple">
<dt>Gibbs sampling split.</dt><dd><p>First entry is the branch names to run and the second entry is the index
into the leaves/parameters for this Gibbs split.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – Incorrect inputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupMove.setup_proposals">
<span class="sig-name descname"><span class="pre">setup_proposals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupMove.setup_proposals" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup proposals when gibbs sampling.</p>
<p>Get inputs into the proposal including Gibbs split information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of coordinate arrays for all branches.</p></li>
<li><p><strong>branches_inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(coords, inds, at_least_one_proposal)</dt><dd><ul class="simple">
<li><p>Coords including Gibbs sampling info.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inds</span></code> including Gibbs sampling info.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">at_least_one_proposal</span></code> is boolean. It is passed out to</dt><dd><p>indicate there is at least one leaf available for the requested branch names.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.GroupMove.temperature_control">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">temperature_control</span></span><a class="headerlink" href="#eryn.moves.GroupMove.temperature_control" title="Permalink to this definition">¶</a></dt>
<dd><p>Temperature controller</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupMove.tune">
<span class="sig-name descname"><span class="pre">tune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupMove.tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Tune a proposal</p>
<p>This is a place holder for tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – Current state of sampler.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Accepted values for last pass
through proposal.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupMove.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupMove.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a given subset of the ensemble with an accepted proposal</p>
<p>This class was updated from <code class="docutils literal notranslate"><span class="pre">emcee</span></code> to handle the added structure
of Eryn.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with current information.
New information is added to this state.</p></li>
<li><p><strong>new_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with information from proposed
points.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – A vector of booleans indicating
which walkers were accepted.</p></li>
<li><p><strong>subset</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em><em>, </em><em>optional</em>) – A boolean mask
indicating which walkers were included in the subset.
This can be used, for example, when updating only the
primary ensemble in a <a class="reference internal" href="#eryn.moves.RedBlueMove" title="eryn.moves.RedBlueMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedBlueMove</span></code></a>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">old_state</span></code> with accepted points added from <code class="docutils literal notranslate"><span class="pre">new_state</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="implemented-group-moves">
<h3>Implemented Group Moves<a class="headerlink" href="#implemented-group-moves" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="eryn.moves.GroupStretchMove">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">eryn.moves.</span></span><span class="sig-name descname"><span class="pre">GroupStretchMove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupStretchMove" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#eryn.moves.GroupMove" title="eryn.moves.group.GroupMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.moves.group.GroupMove</span></code></a>, <a class="reference internal" href="#eryn.moves.StretchMove" title="eryn.moves.stretch.StretchMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.moves.stretch.StretchMove</span></code></a></p>
<p>Affine-Invariant Proposal</p>
<p>A <a class="reference external" href="https://msp.org/camcos/2010/5-1/p04.xhtml">Goodman &amp; Weare (2010)</a> “stretch move” with
parallelization as described in <a class="reference external" href="https://arxiv.org/abs/1202.3665">Foreman-Mackey et al. (2013)</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (<em>double</em><em>, </em><em>optional</em>) – The stretch scale parameter. (default: <code class="docutils literal notranslate"><span class="pre">2.0</span></code>)</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="eryn.moves.GroupStretchMove.a">
<span class="sig-name descname"><span class="pre">a</span></span><a class="headerlink" href="#eryn.moves.GroupStretchMove.a" title="Permalink to this definition">¶</a></dt>
<dd><p>The stretch scale parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>double</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupStretchMove.adjust_factors">
<span class="sig-name descname"><span class="pre">adjust_factors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndims_old</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndims_new</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupStretchMove.adjust_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjust the <code class="docutils literal notranslate"><span class="pre">factors</span></code> based on changing dimensions.</p>
<p><code class="docutils literal notranslate"><span class="pre">factors</span></code> is adjusted in place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>factors</strong> (<em>xp.ndarray</em>) – Array of <code class="docutils literal notranslate"><span class="pre">factors</span></code> values. It is adjusted in place.</p></li>
<li><p><strong>ndims_old</strong> (<em>int</em><em> or </em><em>xp.ndarray</em>) – Old dimension. If given as an <code class="docutils literal notranslate"><span class="pre">xp.ndarray</span></code>,
must be broadcastable with <code class="docutils literal notranslate"><span class="pre">factors</span></code>.</p></li>
<li><p><strong>ndims_new</strong> (<em>int</em><em> or </em><em>xp.ndarray</em>) – New dimension. If given as an <code class="docutils literal notranslate"><span class="pre">xp.ndarray</span></code>,
must be broadcastable with <code class="docutils literal notranslate"><span class="pre">factors</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupStretchMove.get_proposal">
<span class="sig-name descname"><span class="pre">get_proposal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_all</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gibbs_ndim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_inds_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupStretchMove.get_proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate stretch proposal</p>
<p># TODO: add log proposal from ptemcee</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s_all</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values are coordinates
for which a proposal is to be generated.</p></li>
<li><p><strong>c_all</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values are lists. These
lists contain all the complement array values.</p></li>
<li><p><strong>random</strong> (<em>object</em>) – Random state object.</p></li>
<li><p><strong>inds_s</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values are
np.ndarray[nwalkers, nleaves_max] that indicate which leaves
are currently being used in <code class="code docutils literal notranslate"><span class="pre">s_all</span></code>. (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>inds_c</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values are
np.ndarray[nwalkers, nleaves_max] that indicate which leaves
are currently being used in <code class="code docutils literal notranslate"><span class="pre">s_all</span></code>. (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>First entry is new positions. Second entry is detailed balance factors.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Issues with dimensionality.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.GroupStretchMove.acceptance_fraction">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">acceptance_fraction</span></span><a class="headerlink" href="#eryn.moves.GroupStretchMove.acceptance_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Acceptance fraction for this move.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.GroupStretchMove.accepted">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">accepted</span></span><a class="headerlink" href="#eryn.moves.GroupStretchMove.accepted" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepted counts for this move.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupStretchMove.cleanup_proposals_gibbs">
<span class="sig-name descname"><span class="pre">cleanup_proposals_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupStretchMove.cleanup_proposals_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set all not Gibbs-sampled parameters back</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>q</strong> (<em>dict</em>) – Dictionary of new coordinate arrays for all branches.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of old coordinate arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupStretchMove.compute_log_posterior_basic">
<span class="sig-name descname"><span class="pre">compute_log_posterior_basic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupStretchMove.compute_log_posterior_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log of posterior</p>
<p><span class="math notranslate nohighlight">\(\log{P} = \log{L} + \log{p}\)</span></p>
<p>This method is to mesh with the tempered log posterior computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logl</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-likelihood values.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-prior values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Log-Posterior values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray[ntemps, nwalkers]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupStretchMove.fix_logp_gibbs">
<span class="sig-name descname"><span class="pre">fix_logp_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupStretchMove.fix_logp_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set any walker with no leaves to have logp = -np.inf</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em>) – Log of the prior going into final posterior computation.</p></li>
<li><p><strong>inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupStretchMove.get_new_points">
<span class="sig-name descname"><span class="pre">get_new_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_number_generator</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupStretchMove.get_new_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Get mew points in stretch move.</p>
<p>Takes compliment and uses it to get new points for those being proposed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Branch name.</p></li>
<li><p><strong>s</strong> (<em>np.ndarray</em>) – Points to be moved with shape <code class="docutils literal notranslate"><span class="pre">(ntemps,</span> <span class="pre">Ns,</span> <span class="pre">nleaves_max,</span> <span class="pre">ndim)</span></code>.</p></li>
<li><p><strong>c</strong> (<em>np.ndarray</em>) – Compliment to move points with shape <code class="docutils literal notranslate"><span class="pre">(ntemps,</span> <span class="pre">Ns,</span> <span class="pre">nleaves_max,</span> <span class="pre">ndim)</span></code>.</p></li>
<li><p><strong>Ns</strong> (<em>int</em>) – Number to generate.</p></li>
<li><p><strong>branch_shape</strong> (<em>tuple</em>) – Full branch shape.</p></li>
<li><p><strong>branch_i</strong> (<em>int</em>) – Which branch in the order is being run now. This ensures that the
randomly generated quantity per walker remains the same over branches.</p></li>
<li><p><strong>random_number_generator</strong> (<em>object</em>) – Random state object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>New proposed points with shape <code class="docutils literal notranslate"><span class="pre">(ntemps,</span> <span class="pre">Ns,</span> <span class="pre">nleaves_max,</span> <span class="pre">ndim)</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupStretchMove.gibbs_sampling_setup_iterator">
<span class="sig-name descname"><span class="pre">gibbs_sampling_setup_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_branch_names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupStretchMove.gibbs_sampling_setup_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate through the gibbs splits as a generator</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>all_branch_names</strong> (<em>list</em>) – List of all branch names.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>2-tuple</em> –</p>
<dl class="simple">
<dt>Gibbs sampling split.</dt><dd><p>First entry is the branch names to run and the second entry is the index
into the leaves/parameters for this Gibbs split.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – Incorrect inputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupStretchMove.propose">
<span class="sig-name descname"><span class="pre">propose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupStretchMove.propose" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the move to generate a proposal and compute the acceptance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.model.Model</span></code>) – Carrier of sampler information.</p></li>
<li><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code>) – Current state of the sampler.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>State of sampler after proposal is complete.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupStretchMove.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branches</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupStretchMove.setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Any setup necessary for the proposal</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupStretchMove.setup_proposals">
<span class="sig-name descname"><span class="pre">setup_proposals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupStretchMove.setup_proposals" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup proposals when gibbs sampling.</p>
<p>Get inputs into the proposal including Gibbs split information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of coordinate arrays for all branches.</p></li>
<li><p><strong>branches_inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(coords, inds, at_least_one_proposal)</dt><dd><ul class="simple">
<li><p>Coords including Gibbs sampling info.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inds</span></code> including Gibbs sampling info.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">at_least_one_proposal</span></code> is boolean. It is passed out to</dt><dd><p>indicate there is at least one leaf available for the requested branch names.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.GroupStretchMove.temperature_control">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">temperature_control</span></span><a class="headerlink" href="#eryn.moves.GroupStretchMove.temperature_control" title="Permalink to this definition">¶</a></dt>
<dd><p>Temperature controller</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupStretchMove.tune">
<span class="sig-name descname"><span class="pre">tune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupStretchMove.tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Tune a proposal</p>
<p>This is a place holder for tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – Current state of sampler.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Accepted values for last pass
through proposal.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.GroupStretchMove.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.GroupStretchMove.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a given subset of the ensemble with an accepted proposal</p>
<p>This class was updated from <code class="docutils literal notranslate"><span class="pre">emcee</span></code> to handle the added structure
of Eryn.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with current information.
New information is added to this state.</p></li>
<li><p><strong>new_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with information from proposed
points.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – A vector of booleans indicating
which walkers were accepted.</p></li>
<li><p><strong>subset</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em><em>, </em><em>optional</em>) – A boolean mask
indicating which walkers were included in the subset.
This can be used, for example, when updating only the
primary ensemble in a <a class="reference internal" href="#eryn.moves.RedBlueMove" title="eryn.moves.RedBlueMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedBlueMove</span></code></a>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">old_state</span></code> with accepted points added from <code class="docutils literal notranslate"><span class="pre">new_state</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="reversible-jump-moves">
<h2>Reversible Jump Moves<a class="headerlink" href="#reversible-jump-moves" title="Permalink to this headline">¶</a></h2>
<section id="reversible-jump-parent-class">
<h3>Reversible Jump Parent Class<a class="headerlink" href="#reversible-jump-parent-class" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="eryn.moves.ReversibleJump">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">eryn.moves.</span></span><span class="sig-name descname"><span class="pre">ReversibleJump</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">max_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dr_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_change</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.ReversibleJump" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#eryn.moves.Move" title="eryn.moves.move.Move"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.moves.move.Move</span></code></a></p>
<p>An abstract reversible jump move from # TODO: add citations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_k</strong> (<em>int</em><em> or </em><em>list of int</em>) – Maximum number(s) of leaves for each model.</p></li>
<li><p><strong>min_k</strong> (<em>int</em><em> or </em><em>list of int</em>) – Minimum number(s) of leaves for each model.</p></li>
<li><p><strong>tune</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, tune proposal. (Default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
<li><p><strong>fix_change</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Fix the change in the number of leaves. Make them all
add a leaf or remove a leaf. This can be useful for some search functions. Options
are <code class="docutils literal notranslate"><span class="pre">+1</span></code> or <code class="docutils literal notranslate"><span class="pre">-1</span></code>. (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.ReversibleJump.tune">
<span class="sig-name descname"><span class="pre">tune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.ReversibleJump.tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Tune a proposal</p>
<p>This is a place holder for tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – Current state of sampler.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Accepted values for last pass
through proposal.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.ReversibleJump.get_proposal">
<span class="sig-name descname"><span class="pre">get_proposal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_inds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_inds_for_change</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.ReversibleJump.get_proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a proposal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_coords</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code>. Values are
np.ndarray[ntemps, nwalkers, nleaves_max, ndim]. These are the curent
coordinates for all the walkers.</p></li>
<li><p><strong>all_inds</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code>. Values are
np.ndarray[ntemps, nwalkers, nleaves_max]. These are the boolean
arrays marking which leaves are currently used within each walker.</p></li>
<li><p><strong>min_k_all</strong> (<em>list</em>) – Minimum values of leaf ount for each model. Must have same order as <code class="docutils literal notranslate"><span class="pre">all_cords</span></code>.</p></li>
<li><p><strong>max_k_all</strong> (<em>list</em>) – Maximum values of leaf ount for each model. Must have same order as <code class="docutils literal notranslate"><span class="pre">all_cords</span></code>.</p></li>
<li><p><strong>random</strong> (<em>object</em>) – Current random state of the sampler.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Kwargs for modularity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple containing proposal information.</dt><dd><p>First entry is the new coordinates as a dictionary with keys
as <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values as
<code class="docutils literal notranslate"><span class="pre">double</span> <span class="pre">``</span> <span class="pre">np.ndarray[ntemps,</span> <span class="pre">nwalkers,</span> <span class="pre">nleaves_max,</span> <span class="pre">ndim]</span> <span class="pre">containing</span>
<span class="pre">proposed</span> <span class="pre">coordinates.</span> <span class="pre">Second</span> <span class="pre">entry</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">new</span> <span class="pre">``inds</span></code> array with
boolean values flipped for added or removed sources. Third entry
is the factors associated with the
proposal necessary for detailed balance. This is effectively
any term in the detailed balance fraction. +log of factors if
in the numerator. -log of factors if in the denominator.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – If this proposal is not implemented by a subclass.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.ReversibleJump.get_model_change_proposal">
<span class="sig-name descname"><span class="pre">get_model_change_proposal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.ReversibleJump.get_model_change_proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for changing the model count by 1.</p>
<p>This helper function works with nested models where you want to add or remove
one leaf at a time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inds</strong> (<em>np.ndarray</em>) – <code class="docutils literal notranslate"><span class="pre">inds</span></code> values for this specific branch with shape
<code class="docutils literal notranslate"><span class="pre">(ntemps,</span> <span class="pre">nwalkers,</span> <span class="pre">nleaves_max)</span></code>.</p></li>
<li><p><strong>random</strong> (<em>object</em>) – Current random state of the sampler.</p></li>
<li><p><strong>min_k</strong> (<em>int</em>) – Minimum allowable leaf count for this branch.</p></li>
<li><p><strong>max_k</strong> (<em>int</em>) – Maximum allowable leaf count for this branch.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Keys are <code class="docutils literal notranslate"><span class="pre">&quot;+1&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;-1&quot;</span></code>. Values are indexing information.</dt><dd><p><code class="docutils literal notranslate"><span class="pre">&quot;+1&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;-1&quot;</span></code> indicate if a source is being added or removed, respectively.
The indexing information is a 2D array with shape <code class="docutils literal notranslate"><span class="pre">(number</span> <span class="pre">changing,</span> <span class="pre">3)</span></code>.
The length 3 is the index into each of the <code class="docutils literal notranslate"><span class="pre">(ntemps,</span> <span class="pre">nwalkers,</span> <span class="pre">nleaves_max)</span></code>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.ReversibleJump.acceptance_fraction">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">acceptance_fraction</span></span><a class="headerlink" href="#eryn.moves.ReversibleJump.acceptance_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Acceptance fraction for this move.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.ReversibleJump.accepted">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">accepted</span></span><a class="headerlink" href="#eryn.moves.ReversibleJump.accepted" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepted counts for this move.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.ReversibleJump.cleanup_proposals_gibbs">
<span class="sig-name descname"><span class="pre">cleanup_proposals_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.ReversibleJump.cleanup_proposals_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set all not Gibbs-sampled parameters back</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>q</strong> (<em>dict</em>) – Dictionary of new coordinate arrays for all branches.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of old coordinate arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.ReversibleJump.compute_log_posterior_basic">
<span class="sig-name descname"><span class="pre">compute_log_posterior_basic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.ReversibleJump.compute_log_posterior_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log of posterior</p>
<p><span class="math notranslate nohighlight">\(\log{P} = \log{L} + \log{p}\)</span></p>
<p>This method is to mesh with the tempered log posterior computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logl</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-likelihood values.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-prior values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Log-Posterior values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray[ntemps, nwalkers]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.ReversibleJump.fix_logp_gibbs">
<span class="sig-name descname"><span class="pre">fix_logp_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.ReversibleJump.fix_logp_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set any walker with no leaves to have logp = -np.inf</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em>) – Log of the prior going into final posterior computation.</p></li>
<li><p><strong>inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.ReversibleJump.gibbs_sampling_setup_iterator">
<span class="sig-name descname"><span class="pre">gibbs_sampling_setup_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_branch_names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.ReversibleJump.gibbs_sampling_setup_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate through the gibbs splits as a generator</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>all_branch_names</strong> (<em>list</em>) – List of all branch names.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>2-tuple</em> –</p>
<dl class="simple">
<dt>Gibbs sampling split.</dt><dd><p>First entry is the branch names to run and the second entry is the index
into the leaves/parameters for this Gibbs split.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – Incorrect inputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.ReversibleJump.propose">
<span class="sig-name descname"><span class="pre">propose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.ReversibleJump.propose" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the move to generate a proposal and compute the acceptance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.model.Model</span></code>) – Carrier of sampler information.</p></li>
<li><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code>) – Current state of the sampler.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>State of sampler after proposal is complete.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.ReversibleJump.setup_proposals">
<span class="sig-name descname"><span class="pre">setup_proposals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.ReversibleJump.setup_proposals" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup proposals when gibbs sampling.</p>
<p>Get inputs into the proposal including Gibbs split information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of coordinate arrays for all branches.</p></li>
<li><p><strong>branches_inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(coords, inds, at_least_one_proposal)</dt><dd><ul class="simple">
<li><p>Coords including Gibbs sampling info.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inds</span></code> including Gibbs sampling info.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">at_least_one_proposal</span></code> is boolean. It is passed out to</dt><dd><p>indicate there is at least one leaf available for the requested branch names.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.ReversibleJump.temperature_control">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">temperature_control</span></span><a class="headerlink" href="#eryn.moves.ReversibleJump.temperature_control" title="Permalink to this definition">¶</a></dt>
<dd><p>Temperature controller</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.ReversibleJump.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.ReversibleJump.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a given subset of the ensemble with an accepted proposal</p>
<p>This class was updated from <code class="docutils literal notranslate"><span class="pre">emcee</span></code> to handle the added structure
of Eryn.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with current information.
New information is added to this state.</p></li>
<li><p><strong>new_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with information from proposed
points.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – A vector of booleans indicating
which walkers were accepted.</p></li>
<li><p><strong>subset</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em><em>, </em><em>optional</em>) – A boolean mask
indicating which walkers were included in the subset.
This can be used, for example, when updating only the
primary ensemble in a <a class="reference internal" href="#eryn.moves.RedBlueMove" title="eryn.moves.RedBlueMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedBlueMove</span></code></a>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">old_state</span></code> with accepted points added from <code class="docutils literal notranslate"><span class="pre">new_state</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="implemented-reversible-jump-moves">
<h3>Implemented Reversible Jump Moves<a class="headerlink" href="#implemented-reversible-jump-moves" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerateRJ">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">eryn.moves.</span></span><span class="sig-name descname"><span class="pre">DistributionGenerateRJ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerateRJ" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#eryn.moves.ReversibleJump" title="eryn.moves.rj.ReversibleJump"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.moves.rj.ReversibleJump</span></code></a></p>
<p>Generate Revesible-Jump proposals from prior</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>priors</strong> (<em>object</em>) – <code class="xref py py-class docutils literal notranslate"><span class="pre">ProbDistContainer</span></code> object that has <code class="docutils literal notranslate"><span class="pre">logpdf</span></code>
and <code class="docutils literal notranslate"><span class="pre">rvs</span></code> methods.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerateRJ.get_proposal">
<span class="sig-name descname"><span class="pre">get_proposal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_inds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_k_all</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_k_all</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerateRJ.get_proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a proposal</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_coords</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code>. Values are
np.ndarray[ntemps, nwalkers, nleaves_max, ndim]. These are the curent
coordinates for all the walkers.</p></li>
<li><p><strong>all_inds</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code>. Values are
np.ndarray[ntemps, nwalkers, nleaves_max]. These are the boolean
arrays marking which leaves are currently used within each walker.</p></li>
<li><p><strong>all_inds_for_change</strong> (<em>dict</em>) – Keys are <code class="docutils literal notranslate"><span class="pre">branch_names</span></code>. Values are
dictionaries. These dictionaries have keys <code class="docutils literal notranslate"><span class="pre">&quot;+1&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;-1&quot;</span></code>,
indicating waklkers that are adding or removing a leafm respectively.
The values for these dicts are <code class="docutils literal notranslate"><span class="pre">int</span></code> np.ndarray[…, 3]. The “…” indicates
the number of walkers in all temperatures that fall under either adding
or removing a leaf. The second dimension, 3, is the indexes into
the three-dimensional arrays within <code class="docutils literal notranslate"><span class="pre">all_inds</span></code> of the specific leaf
that is being added or removed from those leaves currently considered.</p></li>
<li><p><strong>random</strong> (<em>object</em>) – Current random state of the sampler.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple containing proposal information.</dt><dd><p>First entry is the new coordinates as a dictionary with keys
as <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> and values as
<code class="docutils literal notranslate"><span class="pre">double</span> <span class="pre">``</span> <span class="pre">np.ndarray[ntemps,</span> <span class="pre">nwalkers,</span> <span class="pre">nleaves_max,</span> <span class="pre">ndim]</span> <span class="pre">containing</span>
<span class="pre">proposed</span> <span class="pre">coordinates.</span> <span class="pre">Second</span> <span class="pre">entry</span> <span class="pre">is</span> <span class="pre">the</span> <span class="pre">new</span> <span class="pre">``inds</span></code> array with
boolean values flipped for added or removed sources. Third entry
is the factors associated with the
proposal necessary for detailed balance. This is effectively
any term in the detailed balance fraction. +log of factors if
in the numerator. -log of factors if in the denominator.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerateRJ.acceptance_fraction">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">acceptance_fraction</span></span><a class="headerlink" href="#eryn.moves.DistributionGenerateRJ.acceptance_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Acceptance fraction for this move.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerateRJ.accepted">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">accepted</span></span><a class="headerlink" href="#eryn.moves.DistributionGenerateRJ.accepted" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepted counts for this move.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerateRJ.cleanup_proposals_gibbs">
<span class="sig-name descname"><span class="pre">cleanup_proposals_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerateRJ.cleanup_proposals_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set all not Gibbs-sampled parameters back</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>q</strong> (<em>dict</em>) – Dictionary of new coordinate arrays for all branches.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of old coordinate arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerateRJ.compute_log_posterior_basic">
<span class="sig-name descname"><span class="pre">compute_log_posterior_basic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerateRJ.compute_log_posterior_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log of posterior</p>
<p><span class="math notranslate nohighlight">\(\log{P} = \log{L} + \log{p}\)</span></p>
<p>This method is to mesh with the tempered log posterior computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logl</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-likelihood values.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-prior values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Log-Posterior values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray[ntemps, nwalkers]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerateRJ.fix_logp_gibbs">
<span class="sig-name descname"><span class="pre">fix_logp_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerateRJ.fix_logp_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set any walker with no leaves to have logp = -np.inf</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em>) – Log of the prior going into final posterior computation.</p></li>
<li><p><strong>inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerateRJ.get_model_change_proposal">
<span class="sig-name descname"><span class="pre">get_model_change_proposal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerateRJ.get_model_change_proposal" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function for changing the model count by 1.</p>
<p>This helper function works with nested models where you want to add or remove
one leaf at a time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inds</strong> (<em>np.ndarray</em>) – <code class="docutils literal notranslate"><span class="pre">inds</span></code> values for this specific branch with shape
<code class="docutils literal notranslate"><span class="pre">(ntemps,</span> <span class="pre">nwalkers,</span> <span class="pre">nleaves_max)</span></code>.</p></li>
<li><p><strong>random</strong> (<em>object</em>) – Current random state of the sampler.</p></li>
<li><p><strong>min_k</strong> (<em>int</em>) – Minimum allowable leaf count for this branch.</p></li>
<li><p><strong>max_k</strong> (<em>int</em>) – Maximum allowable leaf count for this branch.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Keys are <code class="docutils literal notranslate"><span class="pre">&quot;+1&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;-1&quot;</span></code>. Values are indexing information.</dt><dd><p><code class="docutils literal notranslate"><span class="pre">&quot;+1&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;-1&quot;</span></code> indicate if a source is being added or removed, respectively.
The indexing information is a 2D array with shape <code class="docutils literal notranslate"><span class="pre">(number</span> <span class="pre">changing,</span> <span class="pre">3)</span></code>.
The length 3 is the index into each of the <code class="docutils literal notranslate"><span class="pre">(ntemps,</span> <span class="pre">nwalkers,</span> <span class="pre">nleaves_max)</span></code>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerateRJ.gibbs_sampling_setup_iterator">
<span class="sig-name descname"><span class="pre">gibbs_sampling_setup_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_branch_names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerateRJ.gibbs_sampling_setup_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate through the gibbs splits as a generator</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>all_branch_names</strong> (<em>list</em>) – List of all branch names.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>2-tuple</em> –</p>
<dl class="simple">
<dt>Gibbs sampling split.</dt><dd><p>First entry is the branch names to run and the second entry is the index
into the leaves/parameters for this Gibbs split.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – Incorrect inputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerateRJ.propose">
<span class="sig-name descname"><span class="pre">propose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerateRJ.propose" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the move to generate a proposal and compute the acceptance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.model.Model</span></code>) – Carrier of sampler information.</p></li>
<li><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code>) – Current state of the sampler.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>State of sampler after proposal is complete.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerateRJ.setup_proposals">
<span class="sig-name descname"><span class="pre">setup_proposals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerateRJ.setup_proposals" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup proposals when gibbs sampling.</p>
<p>Get inputs into the proposal including Gibbs split information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of coordinate arrays for all branches.</p></li>
<li><p><strong>branches_inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(coords, inds, at_least_one_proposal)</dt><dd><ul class="simple">
<li><p>Coords including Gibbs sampling info.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inds</span></code> including Gibbs sampling info.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">at_least_one_proposal</span></code> is boolean. It is passed out to</dt><dd><p>indicate there is at least one leaf available for the requested branch names.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerateRJ.temperature_control">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">temperature_control</span></span><a class="headerlink" href="#eryn.moves.DistributionGenerateRJ.temperature_control" title="Permalink to this definition">¶</a></dt>
<dd><p>Temperature controller</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerateRJ.tune">
<span class="sig-name descname"><span class="pre">tune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerateRJ.tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Tune a proposal</p>
<p>This is a place holder for tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – Current state of sampler.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Accepted values for last pass
through proposal.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.DistributionGenerateRJ.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.DistributionGenerateRJ.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a given subset of the ensemble with an accepted proposal</p>
<p>This class was updated from <code class="docutils literal notranslate"><span class="pre">emcee</span></code> to handle the added structure
of Eryn.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with current information.
New information is added to this state.</p></li>
<li><p><strong>new_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with information from proposed
points.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – A vector of booleans indicating
which walkers were accepted.</p></li>
<li><p><strong>subset</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em><em>, </em><em>optional</em>) – A boolean mask
indicating which walkers were included in the subset.
This can be used, for example, when updating only the
primary ensemble in a <a class="reference internal" href="#eryn.moves.RedBlueMove" title="eryn.moves.RedBlueMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedBlueMove</span></code></a>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">old_state</span></code> with accepted points added from <code class="docutils literal notranslate"><span class="pre">new_state</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="utility-moves">
<h2>Utility Moves<a class="headerlink" href="#utility-moves" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="eryn.moves.CombineMove">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">eryn.moves.</span></span><span class="sig-name descname"><span class="pre">CombineMove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">moves</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.CombineMove" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#eryn.moves.Move" title="eryn.moves.move.Move"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.moves.move.Move</span></code></a></p>
<p>Move that combines specific moves in order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>moves</strong> (<em>list</em>) – List of moves, similar to how <code class="docutils literal notranslate"><span class="pre">moves</span></code> is submitted
to <a class="reference internal" href="ensemble.html#eryn.ensemble.EnsembleSampler" title="eryn.ensemble.EnsembleSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.ensemble.EnsembleSampler</span></code></a>. If weights are provided,
they will be ignored.</p></li>
<li><p><strong>*args</strong> (<em>tuple</em><em>, </em><em>optional</em>) – args to be passed to <a class="reference internal" href="#eryn.moves.Move" title="eryn.moves.Move"><code class="xref py py-class docutils literal notranslate"><span class="pre">Move</span></code></a>.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, use <code class="docutils literal notranslate"><span class="pre">tqdm</span></code> to show progress throught steps.
This can be very helpful when debugging.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – kwargs to be passed to <a class="reference internal" href="#eryn.moves.Move" title="eryn.moves.Move"><code class="xref py py-class docutils literal notranslate"><span class="pre">Move</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.CombineMove.accepted">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">accepted</span></span><a class="headerlink" href="#eryn.moves.CombineMove.accepted" title="Permalink to this definition">¶</a></dt>
<dd><p>Accepted counts for each move.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.CombineMove.acceptance_fraction">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">acceptance_fraction</span></span><a class="headerlink" href="#eryn.moves.CombineMove.acceptance_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>get acceptance fraction averaged over all moves</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.CombineMove.acceptance_fraction_separate">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">acceptance_fraction_separate</span></span><a class="headerlink" href="#eryn.moves.CombineMove.acceptance_fraction_separate" title="Permalink to this definition">¶</a></dt>
<dd><p>get acceptance fraction from each move</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.CombineMove.temperature_control">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">temperature_control</span></span><a class="headerlink" href="#eryn.moves.CombineMove.temperature_control" title="Permalink to this definition">¶</a></dt>
<dd><p>temperature controller</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.CombineMove.cleanup_proposals_gibbs">
<span class="sig-name descname"><span class="pre">cleanup_proposals_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.CombineMove.cleanup_proposals_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set all not Gibbs-sampled parameters back</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>q</strong> (<em>dict</em>) – Dictionary of new coordinate arrays for all branches.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of old coordinate arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.CombineMove.compute_log_posterior_basic">
<span class="sig-name descname"><span class="pre">compute_log_posterior_basic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.CombineMove.compute_log_posterior_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log of posterior</p>
<p><span class="math notranslate nohighlight">\(\log{P} = \log{L} + \log{p}\)</span></p>
<p>This method is to mesh with the tempered log posterior computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logl</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-likelihood values.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Log-prior values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Log-Posterior values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray[ntemps, nwalkers]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.CombineMove.fix_logp_gibbs">
<span class="sig-name descname"><span class="pre">fix_logp_gibbs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.CombineMove.fix_logp_gibbs" title="Permalink to this definition">¶</a></dt>
<dd><p>Set any walker with no leaves to have logp = -np.inf</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>logp</strong> (<em>np.ndarray</em>) – Log of the prior going into final posterior computation.</p></li>
<li><p><strong>inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.CombineMove.gibbs_sampling_setup_iterator">
<span class="sig-name descname"><span class="pre">gibbs_sampling_setup_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_branch_names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.CombineMove.gibbs_sampling_setup_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate through the gibbs splits as a generator</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>all_branch_names</strong> (<em>list</em>) – List of all branch names.</p>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><p><em>2-tuple</em> –</p>
<dl class="simple">
<dt>Gibbs sampling split.</dt><dd><p>First entry is the branch names to run and the second entry is the index
into the leaves/parameters for this Gibbs split.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – Incorrect inputs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.CombineMove.setup_proposals">
<span class="sig-name descname"><span class="pre">setup_proposals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">branch_names_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds_run</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.CombineMove.setup_proposals" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup proposals when gibbs sampling.</p>
<p>Get inputs into the proposal including Gibbs split information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>branch_names_run</strong> (<em>list</em>) – List of branch names to run concurrently.</p></li>
<li><p><strong>inds_run</strong> (<em>list</em>) – List of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays including Gibbs sampling information.</p></li>
<li><p><strong>branches_coords</strong> (<em>dict</em>) – Dictionary of coordinate arrays for all branches.</p></li>
<li><p><strong>branches_inds</strong> (<em>dict</em>) – Dictionary of <code class="docutils literal notranslate"><span class="pre">inds</span></code> arrays for all branches.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(coords, inds, at_least_one_proposal)</dt><dd><ul class="simple">
<li><p>Coords including Gibbs sampling info.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inds</span></code> including Gibbs sampling info.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">at_least_one_proposal</span></code> is boolean. It is passed out to</dt><dd><p>indicate there is at least one leaf available for the requested branch names.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.CombineMove.tune">
<span class="sig-name descname"><span class="pre">tune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.CombineMove.tune" title="Permalink to this definition">¶</a></dt>
<dd><p>Tune a proposal</p>
<p>This is a place holder for tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – Current state of sampler.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – Accepted values for last pass
through proposal.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.CombineMove.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accepted</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.CombineMove.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a given subset of the ensemble with an accepted proposal</p>
<p>This class was updated from <code class="docutils literal notranslate"><span class="pre">emcee</span></code> to handle the added structure
of Eryn.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>old_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with current information.
New information is added to this state.</p></li>
<li><p><strong>new_state</strong> (<a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a>) – State with information from proposed
points.</p></li>
<li><p><strong>accepted</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em>) – A vector of booleans indicating
which walkers were accepted.</p></li>
<li><p><strong>subset</strong> (<em>np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em><em>, </em><em>optional</em>) – A boolean mask
indicating which walkers were included in the subset.
This can be used, for example, when updating only the
primary ensemble in a <a class="reference internal" href="#eryn.moves.RedBlueMove" title="eryn.moves.RedBlueMove"><code class="xref py py-class docutils literal notranslate"><span class="pre">RedBlueMove</span></code></a>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">old_state</span></code> with accepted points added from <code class="docutils literal notranslate"><span class="pre">new_state</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="state.html#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.moves.CombineMove.periodic">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">periodic</span></span><a class="headerlink" href="#eryn.moves.CombineMove.periodic" title="Permalink to this definition">¶</a></dt>
<dd><p>periodic parameter information</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.moves.CombineMove.propose">
<span class="sig-name descname"><span class="pre">propose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.moves.CombineMove.propose" title="Permalink to this definition">¶</a></dt>
<dd><p>Propose a combined move.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.model.Model</span></code>) – Carrier of sampler information.</p></li>
<li><p><strong>state</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code>) – Current state of the sampler.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>(state, accepted)</dt><dd><p>The first return is the state of the sampler after the move.
The second return value is the accepted count array for each walker
counting for all proposals.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="prior.html" class="btn btn-neutral float-right" title="Priors" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="backend.html" class="btn btn-neutral float-left" title="Backends" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Michael Katz and Nikos Karnesis.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>