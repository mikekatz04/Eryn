

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>State &mdash; Eryn 0.0.1 documentation</title>
<<<<<<< HEAD
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=d45e8c67"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
=======
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=d45e8c67"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
>>>>>>> c377795 (fixed stretch in ndim=1)
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Backends" href="backend.html" />
    <link rel="prev" title="Ensemble" href="ensemble.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: coral" >

          
          
          <a href="../index.html" class="icon icon-home">
            Eryn
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Documentation:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="ensemble.html">Ensemble</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">State</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#eryn.state.State"><code class="docutils literal notranslate"><span class="pre">State</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#eryn.state.State.branches_inds"><code class="docutils literal notranslate"><span class="pre">State.branches_inds</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#eryn.state.State.branches_coords"><code class="docutils literal notranslate"><span class="pre">State.branches_coords</span></code></a></li>
<<<<<<< HEAD
<li class="toctree-l3"><a class="reference internal" href="#eryn.state.State.branches_supplemental"><code class="docutils literal notranslate"><span class="pre">State.branches_supplemental</span></code></a></li>
=======
<li class="toctree-l3"><a class="reference internal" href="#eryn.state.State.branches_supplimental"><code class="docutils literal notranslate"><span class="pre">State.branches_supplimental</span></code></a></li>
>>>>>>> c377795 (fixed stretch in ndim=1)
<li class="toctree-l3"><a class="reference internal" href="#eryn.state.State.branch_names"><code class="docutils literal notranslate"><span class="pre">State.branch_names</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#eryn.state.State.get_log_posterior"><code class="docutils literal notranslate"><span class="pre">State.get_log_posterior()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#eryn.state.Branch"><code class="docutils literal notranslate"><span class="pre">Branch</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#eryn.state.Branch.nleaves"><code class="docutils literal notranslate"><span class="pre">Branch.nleaves</span></code></a></li>
</ul>
</li>
<<<<<<< HEAD
=======
<li class="toctree-l2"><a class="reference internal" href="#eryn.state.BranchSupplimental"><code class="docutils literal notranslate"><span class="pre">BranchSupplimental</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#eryn.state.BranchSupplimental.holder"><code class="docutils literal notranslate"><span class="pre">BranchSupplimental.holder</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#eryn.state.BranchSupplimental.add_objects"><code class="docutils literal notranslate"><span class="pre">BranchSupplimental.add_objects()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#eryn.state.BranchSupplimental.remove_objects"><code class="docutils literal notranslate"><span class="pre">BranchSupplimental.remove_objects()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#eryn.state.BranchSupplimental.contained_objects"><code class="docutils literal notranslate"><span class="pre">BranchSupplimental.contained_objects</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#eryn.state.BranchSupplimental.take_along_axis"><code class="docutils literal notranslate"><span class="pre">BranchSupplimental.take_along_axis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#eryn.state.BranchSupplimental.put_along_axis"><code class="docutils literal notranslate"><span class="pre">BranchSupplimental.put_along_axis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#eryn.state.BranchSupplimental.flat"><code class="docutils literal notranslate"><span class="pre">BranchSupplimental.flat</span></code></a></li>
</ul>
</li>
>>>>>>> c377795 (fixed stretch in ndim=1)
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="backend.html">Backends</a></li>
<li class="toctree-l1"><a class="reference internal" href="moves.html">Moves</a></li>
<li class="toctree-l1"><a class="reference internal" href="prior.html">Priors</a></li>
<li class="toctree-l1"><a class="reference internal" href="temper.html">Parallel Tempering</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utilities</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorial:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/Eryn_tutorial.html">Eryn Basic Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/more_tutorials.html">More Advanced Eryn Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">General Information:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general/todos.html">Code Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general/todos.html#code-todos">Code TODOs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: coral" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Eryn</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">State</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/user/state.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="ensemble.html" class="btn btn-neutral float-left" title="Ensemble" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="backend.html" class="btn btn-neutral float-right" title="Backends" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="state">
<h1>State<a class="headerlink" href="#state" title="Link to this heading"></a></h1>
<<<<<<< HEAD
<p>The <a class="reference internal" href="#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a> carries the information around for all walkers at a given step. The individual branches are carried in <a class="reference internal" href="#eryn.state.Branch" title="eryn.state.Branch"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.Branch</span></code></a> class objects. A utility provided for state objects is the <code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.BranchSupplimental</span></code> object. This object can carry information around the sampler while being indexed and moved around just like other sampler information. See the tutorial for more information.</p>
<dl class="py class">
<dt class="sig sig-object py" id="eryn.state.State">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">eryn.state.</span></span><span class="sig-name descname"><span class="pre">State</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_supplemental</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supplemental</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_like</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">betas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.state.State" title="Link to this definition"></a></dt>
=======
<p>The <a class="reference internal" href="#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.State</span></code></a> carries the information around for all walkers at a given step. The individual branches are carried in <a class="reference internal" href="#eryn.state.Branch" title="eryn.state.Branch"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.Branch</span></code></a> class objects. A utility provided for state objects is the <a class="reference internal" href="#eryn.state.BranchSupplimental" title="eryn.state.BranchSupplimental"><code class="xref py py-class docutils literal notranslate"><span class="pre">eryn.state.BranchSupplimental</span></code></a> object. This object can carry information around the sampler while being indexed and moved around just like other sampler information. See the tutorial for more information.</p>
<dl class="py class">
<dt class="sig sig-object py" id="eryn.state.State">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">eryn.state.</span></span><span class="sig-name descname"><span class="pre">State</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_supplimental</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">supplimental</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_like</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">betas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.state.State" title="Link to this definition"></a></dt>
>>>>>>> c377795 (fixed stretch in ndim=1)
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The state of the ensemble during an MCMC run</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (double ndarray[ntemps, nwalkers, nleaves_max, ndim], dict, or <a class="reference internal" href="#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a>) – The current positions of the walkers
in the parameter space. If dict, need to use <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> for the keys.</p></li>
<li><p><strong>inds</strong> (<em>bool ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>, </em><em>nleaves_max</em><em>] or </em><em>dict</em><em>, </em><em>optional</em>) – The information
on which leaves are used and which are not used. A value of True means the specific leaf
was used in this step. If dict, need to use <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> for the keys.
Input should be <code class="docutils literal notranslate"><span class="pre">None</span></code> if a complete <a class="reference internal" href="#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a> object is input for <code class="docutils literal notranslate"><span class="pre">coords</span></code>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>log_like</strong> (<em>ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em><em>, </em><em>optional</em>) – Log likelihoods
for the  walkers at positions given by <code class="docutils literal notranslate"><span class="pre">coords</span></code>.
Input should be <code class="docutils literal notranslate"><span class="pre">None</span></code> if a complete <a class="reference internal" href="#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a> object is input for <code class="docutils literal notranslate"><span class="pre">coords</span></code>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>log_prior</strong> (<em>ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>]</em><em>, </em><em>optional</em>) – Log priors
for the  walkers at positions given by <code class="docutils literal notranslate"><span class="pre">coords</span></code>.
Input should be <code class="docutils literal notranslate"><span class="pre">None</span></code> if a complete <a class="reference internal" href="#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a> object is input for <code class="docutils literal notranslate"><span class="pre">coords</span></code>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>betas</strong> (<em>ndarray</em><em>[</em><em>ntemps</em><em>]</em><em>, </em><em>optional</em>) – Temperatures in the sampler at the current step.
Input should be <code class="docutils literal notranslate"><span class="pre">None</span></code> if a complete <a class="reference internal" href="#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a> object is input for <code class="docutils literal notranslate"><span class="pre">coords</span></code>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>blobs</strong> (<em>ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>, </em><em>nblobs</em><em>]</em><em>, </em><em>Optional</em>) – The metadata “blobs”
associated with the current position. The value is only returned if
lnpostfn returns blobs too.
Input should be <code class="docutils literal notranslate"><span class="pre">None</span></code> if a complete <a class="reference internal" href="#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a> object is input for <code class="docutils literal notranslate"><span class="pre">coords</span></code>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>random_state</strong> (<em>Optional</em>) – The current state of the random number
generator.
Input should be <code class="docutils literal notranslate"><span class="pre">None</span></code> if a complete <a class="reference internal" href="#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a> object is input for <code class="docutils literal notranslate"><span class="pre">coords</span></code>.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>copy</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, copy the the arrays in the former <a class="reference internal" href="#eryn.state.State" title="eryn.state.State"><code class="xref py py-class docutils literal notranslate"><span class="pre">State</span></code></a> obhect.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Dimensions of inputs or input types are incorrect.</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="eryn.state.State.branches_inds">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">branches_inds</span></span><a class="headerlink" href="#eryn.state.State.branches_inds" title="Link to this definition"></a></dt>
<dd><p>Get the <code class="docutils literal notranslate"><span class="pre">inds</span></code> from all branch objects returned as a dictionary with <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> as keys.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.state.State.branches_coords">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">branches_coords</span></span><a class="headerlink" href="#eryn.state.State.branches_coords" title="Link to this definition"></a></dt>
<dd><p>Get the <code class="docutils literal notranslate"><span class="pre">coords</span></code> from all branch objects returned as a dictionary with <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> as keys.</p>
</dd></dl>

<dl class="py property">
<<<<<<< HEAD
<dt class="sig sig-object py" id="eryn.state.State.branches_supplemental">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">branches_supplemental</span></span><a class="headerlink" href="#eryn.state.State.branches_supplemental" title="Link to this definition"></a></dt>
<dd><p>Get the <code class="docutils literal notranslate"><span class="pre">branch.supplemental</span></code> from all branch objects returned as a dictionary with <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> as keys.</p>
=======
<dt class="sig sig-object py" id="eryn.state.State.branches_supplimental">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">branches_supplimental</span></span><a class="headerlink" href="#eryn.state.State.branches_supplimental" title="Link to this definition"></a></dt>
<dd><p>Get the <code class="docutils literal notranslate"><span class="pre">branch.supplimental</span></code> from all branch objects returned as a dictionary with <code class="docutils literal notranslate"><span class="pre">branch_names</span></code> as keys.</p>
>>>>>>> c377795 (fixed stretch in ndim=1)
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.state.State.branch_names">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">branch_names</span></span><a class="headerlink" href="#eryn.state.State.branch_names" title="Link to this definition"></a></dt>
<dd><p>Get the branch names in this state.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.state.State.get_log_posterior">
<span class="sig-name descname"><span class="pre">get_log_posterior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temper</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.state.State.get_log_posterior" title="Link to this definition"></a></dt>
<dd><p>Get the posterior probability</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>temper</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, apply tempering to the posterior computation.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Log of the posterior probability.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray[ntemps, nwalkers]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="eryn.state.Branch">
<<<<<<< HEAD
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">eryn.state.</span></span><span class="sig-name descname"><span class="pre">Branch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_supplemental</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.state.Branch" title="Link to this definition"></a></dt>
=======
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">eryn.state.</span></span><span class="sig-name descname"><span class="pre">Branch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branch_supplimental</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.state.Branch" title="Link to this definition"></a></dt>
>>>>>>> c377795 (fixed stretch in ndim=1)
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Special container for one branch (model)</p>
<p>This class is a key component of Eryn. It this type of object
that allows for different models to be considered simultaneously
within an MCMC run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>4D double np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>, </em><em>nleaves_max</em><em>, </em><em>ndim</em><em>]</em>) – The coordinates
in parameter space of all walkers.</p></li>
<li><p><strong>inds</strong> (<em>3D bool np.ndarray</em><em>[</em><em>ntemps</em><em>, </em><em>nwalkers</em><em>, </em><em>nleaves_max</em><em>]</em><em>, </em><em>optional</em>) – The information
on which leaves are used and which are not used. A value of True means the specific leaf
was used in this step. Parameters from unused walkers are still kept. When they
are output to the backend, the backend saves a special number (default: <code class="docutils literal notranslate"><span class="pre">np.nan</span></code>) for all coords
related to unused leaves at that step. If None, inds will fill with all True values.
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
<li><p><strong>branch_supplemental</strong> (<em>object</em>) – <code class="xref py py-class docutils literal notranslate"><span class="pre">BranchSupplemental</span></code> object specific to this branch. (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – <code class="docutils literal notranslate"><span class="pre">inds</span></code> has wrong shape or number of leaves is less than zero.</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="eryn.state.Branch.nleaves">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nleaves</span></span><a class="headerlink" href="#eryn.state.Branch.nleaves" title="Link to this definition"></a></dt>
<dd><p>Number of leaves for each walker</p>
</dd></dl>

</dd></dl>

<<<<<<< HEAD
=======
<dl class="py class">
<dt class="sig sig-object py" id="eryn.state.BranchSupplimental">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">eryn.state.</span></span><span class="sig-name descname"><span class="pre">BranchSupplimental</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.state.BranchSupplimental" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Special object to carry information through sampler.</p>
<p>The <a class="reference internal" href="#eryn.state.BranchSupplimental" title="eryn.state.BranchSupplimental"><code class="xref py py-class docutils literal notranslate"><span class="pre">BranchSupplimental</span></code></a> object is a holder of information that is
passed through the sampler. It can also be indexed similar to other quantities
carried throughout the sampler.</p>
<p>This indexing is based on the <code class="docutils literal notranslate"><span class="pre">base_shape</span></code>. You can store many objects that have the same base
shape and then index across all of them. For example, if you want to store individual leaf
information, the base shape will be <code class="docutils literal notranslate"><span class="pre">(ntemps,</span> <span class="pre">nwalkers,</span> <span class="pre">nleaves_max)</span></code>.
If you want to store a 2D array per individual leaf, the overall shape will be
<code class="docutils literal notranslate"><span class="pre">(ntemps,</span> <span class="pre">nwalkers,</span> <span class="pre">nleaves_max,</span> <span class="pre">dim2_extra,</span> <span class="pre">dim1_extra)</span></code>. Another type of information is
stored in a class object (for example). Using <code class="docutils literal notranslate"><span class="pre">numpy</span></code> object arrays,
<code class="docutils literal notranslate"><span class="pre">ntemps</span> <span class="pre">*</span> <span class="pre">nwalkers</span> <span class="pre">*</span> <span class="pre">nleaves_max</span></code> number of class objects can be stored in the array. Then,
using special indexing functions, information can be updated/accessed across all objects
stored simultaneously. If you index this class, it will give you back a dictionary with
all objects stored indexed for each leaf. So if you index (0, 0, 0) in our running example,
you will get back a dictionary with one 2D array and one class object from the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> object
array.</p>
<p>All of these objects are stored in <code class="docutils literal notranslate"><span class="pre">self.holder</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj_info</strong> (<em>dict</em>) – Initial information for storage. Keys are the names to be stored under
and values are arrays. These arrays should have a base shape that is equivalent to
<code class="docutils literal notranslate"><span class="pre">base_shape</span></code>, meaning <code class="docutils literal notranslate"><span class="pre">array.shape[:len(base_shape)]</span> <span class="pre">==</span> <span class="pre">self.base_shape</span></code>.
The dimensions beyond the base shape can be anything.</p></li>
<li><p><strong>base_shape</strong> (<em>tuple</em>) – Base shape for indexing. Objects stored in the supplimental object
will have a shape that at minimum is equivalent to <code class="docutils literal notranslate"><span class="pre">base_shape</span></code>.</p></li>
<li><p><strong>copy</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, copy whatever information is given in before it is stored.
if <code class="docutils literal notranslate"><span class="pre">False</span></code>, store directly the input information. (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="eryn.state.BranchSupplimental.holder">
<span class="sig-name descname"><span class="pre">holder</span></span><a class="headerlink" href="#eryn.state.BranchSupplimental.holder" title="Link to this definition"></a></dt>
<dd><p>All of the objects stored for this supplimental object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.state.BranchSupplimental.add_objects">
<span class="sig-name descname"><span class="pre">add_objects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.state.BranchSupplimental.add_objects" title="Link to this definition"></a></dt>
<dd><p>Add objects to the holder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj_info</strong> (<em>dict</em>) – Information for storage. Keys are the names to be stored under
and values are arrays. These arrays should have a base shape that is equivalent to
<code class="docutils literal notranslate"><span class="pre">base_shape</span></code>, meaning <code class="docutils literal notranslate"><span class="pre">array.shape[:len(base_shape)]</span> <span class="pre">==</span> <span class="pre">self.base_shape</span></code>.
The dimensions beyond the base shape can be anything.</p></li>
<li><p><strong>copy</strong> (<em>bool</em><em>, </em><em>optional</em>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, copy whatever information is given in before it is stored.
if <code class="docutils literal notranslate"><span class="pre">False</span></code>, store directly the input information. (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Shape matching issues.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.state.BranchSupplimental.remove_objects">
<span class="sig-name descname"><span class="pre">remove_objects</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.state.BranchSupplimental.remove_objects" title="Link to this definition"></a></dt>
<dd><p>Remove objects from the holder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>names</strong> (<em>str</em><em> or </em><em>list</em><em> of </em><em>str</em>) – Strings associated with information to delete.
Please note it does not return the information.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – Input issues.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.state.BranchSupplimental.contained_objects">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">contained_objects</span></span><a class="headerlink" href="#eryn.state.BranchSupplimental.contained_objects" title="Link to this definition"></a></dt>
<dd><p>The list of keys of contained objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.state.BranchSupplimental.take_along_axis">
<span class="sig-name descname"><span class="pre">take_along_axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.state.BranchSupplimental.take_along_axis" title="Link to this definition"></a></dt>
<dd><p>Take information from contained arrays along an axis.</p>
<p>See <code class="docutils literal notranslate"><span class="pre">`numpy.take_along_axis</span></code> &lt;<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.take_along_axis.html">https://numpy.org/doc/stable/reference/generated/numpy.take_along_axis.html</a>&gt;`_.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>xp.ndarray</em>) – Indices to take along each 1d slice of arr. This must match the dimension
of <code class="docutils literal notranslate"><span class="pre">self.base_shape</span></code>, but other dimensions only need to broadcast against
<code class="docutils literal notranslate"><span class="pre">self.base_shape</span></code>.</p></li>
<li><p><strong>axis</strong> (<em>int</em>) – The axis to take 1d slices along.</p></li>
<li><p><strong>skip_names</strong> (<em>list</em><em> of </em><em>str</em><em>, </em><em>optional</em>) – By default, this function returns the results for
all stored objects. This list gives the strings of objects to leave behind and
not return.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Keys are names of stored objects and values are the proper array slices.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="eryn.state.BranchSupplimental.put_along_axis">
<span class="sig-name descname"><span class="pre">put_along_axis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values_in</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#eryn.state.BranchSupplimental.put_along_axis" title="Link to this definition"></a></dt>
<dd><p>Put information information into contained arrays along an axis.</p>
<p>See <code class="docutils literal notranslate"><span class="pre">`numpy.put_along_axis</span></code> &lt;<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.put_along_axis.html">https://numpy.org/doc/stable/reference/generated/numpy.put_along_axis.html</a>&gt;`_.</p>
<p><strong>Please note</strong> this function is not implemented in <code class="docutils literal notranslate"><span class="pre">cupy</span></code>, so this is a custom implementation
for both <code class="docutils literal notranslate"><span class="pre">cupy</span></code> and <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>xp.ndarray</em>) – Indices to put values along each 1d slice of arr. This must match</p></li>
<li><p><strong>self.base_shape</strong> (<em>the dimension of</em>) – </p></li>
<li><p><strong>against</strong> (<em>but other dimensions only need to broadcast</em>) – </p></li>
<li><p><strong>self.base_shape.</strong> – </p></li>
<li><p><strong>axis</strong> (<em>int</em>) – The axis to put 1d slices along.</p></li>
<li><p><strong>values_in</strong> (<em>dict</em>) – Keys are the objects contained to update. Values are the arrays of these
objects with shape and dimension that can broadcast to match that of indices.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="eryn.state.BranchSupplimental.flat">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">flat</span></span><a class="headerlink" href="#eryn.state.BranchSupplimental.flat" title="Link to this definition"></a></dt>
<dd><p>Get flattened arrays from the stored objects.</p>
<p>Here “flat” is in relation to <code class="docutils literal notranslate"><span class="pre">self.base_shape</span></code>. Beyond <code class="docutils literal notranslate"><span class="pre">self.base_shape</span></code>, the shape is mainted.</p>
</dd></dl>

</dd></dl>

>>>>>>> c377795 (fixed stretch in ndim=1)
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ensemble.html" class="btn btn-neutral float-left" title="Ensemble" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="backend.html" class="btn btn-neutral float-right" title="Backends" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Michael Katz and Nikos Karnesis.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>